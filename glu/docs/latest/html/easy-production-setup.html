<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Easy Production Setup &mdash; glu 5.4.2 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.4.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="glu 5.4.2 documentation" href="index.html" />
    <link rel="next" title="setup.sh tool" href="setup-tool.html" />
    <link rel="prev" title="Configuring glu" href="glu-config.html" />
 
<link rel="stylesheet" href="_static/glu.css" type="text/css" />
<script type="text/javascript" src="http://widgets.twimg.com/j/2/widget.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8362808-6', 'github.io');
  ga('send', 'pageview');

</script>

  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="contents.html">
            <img class="logo" src="_static/glu-logo-214x72.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="contents.html">glu 5.4.2 documentation</a></div>
        <div class="rel">
          <a href="glu-config.html" title="Configuring glu"
             accesskey="P">previous</a> |
          <a href="setup-tool.html" title="setup.sh tool"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

<div class="content-wrapper">
<div class="content">
<div class="document">
  
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="easy-production-setup">
<h1>Easy Production Setup<a class="headerlink" href="#easy-production-setup" title="Permalink to this headline">¶</a></h1>
<p>This document describes how to setup glu for production.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since 5.1.0, this page describes the <em>easy</em> production setup using the now built-in setup tool. If you want to revert to manual configuration (or are using a version prior to 5.1.0), please refer to the <a class="reference internal" href="production-setup.html"><em>old page</em></a>.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Currently glu requires a UNIX like platform (tested on Mac OS X) and the following version of java:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">glu version</th>
<th class="head">java version(s)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.0.0+</td>
<td>java 1.7</td>
</tr>
<tr class="row-odd"><td>4.7.x</td>
<td>java 1.6 (any VM) or java 1.7</td>
</tr>
<tr class="row-even"><td>4.6.x and below</td>
<td>java 1.6 (with Sun/Oracle VM only!)</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Due to a <a class="reference external" href="https://github.com/pongasoft/glu/issues/74">bug with OpenJDK</a> glu prior to 4.7.0 requires the Sun Java VM.</p>
</div>
</div>
<div class="section" id="download-glu">
<h2>Download glu<a class="headerlink" href="#download-glu" title="Permalink to this headline">¶</a></h2>
<p>Download the binary called <tt class="docutils literal"><span class="pre">&lt;version&gt;/org.linkedin.glu.packaging-all-&lt;version&gt;.tgz</span></tt> from <a class="reference external" href="https://bintray.com/pkg/show/general/pongasoft/glu/releases">bintray</a> glu repository.</p>
<p>Untar/Unzip in a location of your choice:</p>
<div class="highlight-text"><div class="highlight"><pre>bin/
lib/
models/
packages/
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">This documentation is available under <tt class="docutils literal"><span class="pre">packages/org.linkedin.glu.console-server-&lt;version&gt;/glu/docs/html</span></tt></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The instructions on this page will assume that <tt class="docutils literal"><span class="pre">$GLU_HOME</span></tt> refers to the location of your choice.</p>
</div>
</div>
<div class="section" id="use-the-setup-tool">
<h2>Use the setup tool<a class="headerlink" href="#use-the-setup-tool" title="Permalink to this headline">¶</a></h2>
<p>The tool <tt class="docutils literal"><span class="pre">$GLU_HOME/bin/setup.sh</span></tt> is used for all the steps and you can get help by issuing <tt class="docutils literal"><span class="pre">$GLU_HOME/bin/setup.sh</span> <span class="pre">-h</span></tt> as well as checking out the <a class="reference internal" href="setup-tool.html"><em>dedicated section</em></a>.</p>
<div class="admonition tip" id="easy-production-setup-target-directory-tip">
<p class="first admonition-title">Tip</p>
<p class="last">By default, the setup tool uses the current directory for its output. It is then recommended to <tt class="docutils literal"><span class="pre">cd</span></tt> into the target directory and issue <tt class="docutils literal"><span class="pre">$GLU_HOME/bin/setup.sh</span></tt> commands. Note that you can also use the <tt class="docutils literal"><span class="pre">-o</span> <span class="pre">xxxx</span></tt> to specify the target directory, or enter it when prompted.</p>
</div>
</div>
<div class="section" id="easy-steps">
<h2>Easy Steps<a class="headerlink" href="#easy-steps" title="Permalink to this headline">¶</a></h2>
<p>If you are trying out glu and you want to be up and running quickly (especially in a distributed environment) without digging too much into the details of all possible ways of configuring glu), then simply follow these quick and easy instructions. Otherwise simply skip to <a class="reference internal" href="#easy-production-setup-detailed-steps"><em>Detailed steps</em></a>.</p>
<ul>
<li><p class="first">create a folder to generate all glu distribution (feel free to change!):</p>
<div class="highlight-text"><div class="highlight"><pre>mkdir /tmp/glu-trial
cd /tmp/glu-trial
</pre></div>
</div>
</li>
<li><p class="first">generate the keys (you will be prompted for a password):</p>
<div class="highlight-text"><div class="highlight"><pre>$GLU_HOME/bin/setup.sh -K -o keys
</pre></div>
</div>
</li>
<li><p class="first">copy quick production model locally (since we are going to edit it):</p>
<div class="highlight-text"><div class="highlight"><pre>mkdir models
cp $GLU_HOME/models/quick-production/glu-meta-model.json.groovy models/
</pre></div>
</div>
</li>
<li><p class="first">edit the model (you just copied) <tt class="docutils literal"><span class="pre">models/glu-meta-model.json.groovy</span></tt>:</p>
<ol class="arabic simple">
<li>copy/paste the section (keys) from the output of the previous command</li>
<li>change the various hosts to the hosts where you want to deploy the glu components</li>
<li>pay attention to the <tt class="docutils literal"><span class="pre">mysqlHost</span></tt> section (check <a class="reference internal" href="console.html#console-configuration-database-mysql"><em>Example for a different database: MySql</em></a> for details for MySql)</li>
<li>pay attention to the <tt class="docutils literal"><span class="pre">installPath</span></tt> which is where the distributions will be installed</li>
</ol>
</li>
<li><p class="first">generate the distributions:</p>
<div class="highlight-text"><div class="highlight"><pre>$GLU_HOME/bin/setup.sh -D -o dists models/glu-meta-model.json.groovy
</pre></div>
</div>
</li>
<li><p class="first">execute the script to install glu (uses <tt class="docutils literal"><span class="pre">scp</span></tt> for remote, <tt class="docutils literal"><span class="pre">cp</span></tt> for <tt class="docutils literal"><span class="pre">localhost</span></tt>): you may want to take a look at the script first (this uses <tt class="docutils literal"><span class="pre">installPath</span></tt>):</p>
<div class="highlight-text"><div class="highlight"><pre>./dists/bin/install-all.sh
</pre></div>
</div>
</li>
<li><p class="first">start ZooKeeper cluster</p>
<ul>
<li><p class="first">login on each machine where there is a ZooKeeper instance and start it:</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/zookeeperctl.sh start
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">configure the cluster (will work only if you have started it!):</p>
<div class="highlight-text"><div class="highlight"><pre>$GLU_HOME/bin/setup.sh -Z -o dists models/glu-meta-model.json.groovy
</pre></div>
</div>
</li>
<li><p class="first">start the agents</p>
<ul>
<li><p class="first">login on each machine where you installed an agent and start it:</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/agentctl.sh start
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">start the console</p>
<ul>
<li><p class="first">login on the machine where you installed the console and start it (if you are using mysql, you need to <a class="reference internal" href="console.html#console-configuration-database-mysql"><em>create the user and start the database</em></a>) first:</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/consolectl.sh start
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<p>You should now have glu up and running.</p>
</div>
<div class="section" id="detailed-steps">
<span id="easy-production-setup-detailed-steps"></span><h2>Detailed steps<a class="headerlink" href="#detailed-steps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="step-1-generate-the-keys-k">
<span id="easy-production-setup-gen-keys"></span><h3>Step 1: Generate the keys <tt class="docutils literal"><span class="pre">[-K]</span></tt><a class="headerlink" href="#step-1-generate-the-keys-k" title="Permalink to this headline">¶</a></h3>
<p>The keys generated in this step are used for the communication to the agents (using REST) which happens over ssl: this allows the agents to trust the originator of the calls. In the event you do not care about security, you can simply skip this step.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Prior to glu 5.1.0, setting up the keys was cumbursome and confusing. Using an automated tool that will do it for you makes it more compelling. As a result, even if you do not care about security, it is still strongly advised to generate keys.</p>
</div>
<p>Issue the following command (see <a class="reference internal" href="#easy-production-setup-target-directory-tip"><em>tip</em></a> above on target directory):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; $GLU_HOME/bin/setup.sh -K
</pre></div>
</div>
<p>You will be prompted for a master password.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The master password should be strong and you should remember it. Although at this time, you will never be prompted for it again, future versions of glu may require it (for enhanced security).</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You may want to provide your own <a class="reference external" href="http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/keytool.html#DName">X.500 distinguished name</a> for the certificates, in which case simply provide the <tt class="docutils literal"><span class="pre">--keys-dname</span> <span class="pre">&quot;CN=cName,</span> <span class="pre">OU=orgUnit,</span> <span class="pre">O=org,</span> <span class="pre">L=city,</span> <span class="pre">S=state,</span> <span class="pre">C=countryCode&quot;</span></tt> parameter when you issue the command.</p>
</div>
<p>The output will look like this (with obviously different values):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; cd /tmp/prod-1
&gt; $GLU_HOME/bin/setup.sh -K
Enter the output directory [/tmp/prod-1]: keys
Generating keys...
Enter a master password:
2013/07/08 17:25:48.761 INFO [KeysGenerator] Created agent.keystore
2013/07/08 17:25:49.505 INFO [KeysGenerator] Created agent.truststore
2013/07/08 17:25:50.389 INFO [KeysGenerator] Created console.keystore
2013/07/08 17:25:51.032 INFO [KeysGenerator] Created console.truststore
Keys have been generated in the following folder: /private/tmp/prod-1/keys
Copy the following section in your meta model (see comment in meta model)
////////////////////////////////////////
def keys = [
  agentKeyStore: [
    uri: &#39;file:/private/tmp/prod-1/keys/agent.keystore&#39;,
    checksum: &#39;jtD9Qfs4tm8C15ZU5qmPdWYDzCl&#39;,
    storePassword: &#39;D_wyb-Sg3-SpD_fubdm06R93R5W2tse79y7-&#39;,
    keyPassword: &#39;o_-T3pW1xlmExnA0MKkl6kw55TaEJecctKt_&#39;
  ],
  agentTrustStore: [
    uri: &#39;file:/private/tmp/prod-1/keys/agent.truststore&#39;,
    checksum: &#39;JdVhmMzJvqJKZXIZWE_HBlljoQY&#39;,
    storePassword: &#39;t0EKxg-I9_6v6TkRAi9pMiw-J5-83pwf35NV&#39;
  ],
  consoleKeyStore: [
    uri: &#39;file:/private/tmp/prod-1/keys/console.keystore&#39;,
    checksum: &#39;yLo5GNNYizecWIzKWYgTTzc-bx3&#39;,
    storePassword: &#39;bgmZ9lwF3r-n6e7oAT9BZywk9g7lt0W-i57-&#39;,
    keyPassword: &#39;9R_L3ykZJk6goTkEo8eGDKcFMn7R6ikCM5N0&#39;
  ],
  consoleTrustStore: [
    uri: &#39;file:/private/tmp/prod-1/keys/console.truststore&#39;,
    checksum: &#39;uFo9Io68OUy4UNs--G_WbmBngAi&#39;,
    storePassword: &#39;EkWVRkEpW0Wq65th9dMFEkiaEitV30wrtkhv&#39;
  ],
]
////////////////////////////////////////
</pre></div>
</div>
<p>The section between the <tt class="docutils literal"><span class="pre">///</span></tt> sections will need to be copy/pasted as-is into your glu meta model (see below).</p>
</div>
<div class="section" id="step-2-create-your-own-meta-model">
<h3>Step 2: Create your own meta-model<a class="headerlink" href="#step-2-create-your-own-meta-model" title="Permalink to this headline">¶</a></h3>
<p>The input to the next step (Step 3) is a glu <a class="reference internal" href="meta-model.html"><em>meta model</em></a>. The glu meta model is a file (or set of files) which describes where the various components of glu will be installed and how they will be configured.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The glu distribution comes with a sample meta model under <tt class="docutils literal"><span class="pre">$GLU_HOME/models/sample-production</span></tt> which you can use as a starting point to define your own model. Also check the documentation about the <a class="reference internal" href="meta-model.html"><em>meta model</em></a> for more details on syntax and options.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The block of code related to keys generated in Step 1, needs to be copied into your meta model.</p>
</div>
</div>
<div class="section" id="step-3-configuring-glu-optional">
<h3>Step 3: Configuring glu (optional)<a class="headerlink" href="#step-3-configuring-glu-optional" title="Permalink to this headline">¶</a></h3>
<p>glu is very configurable and offers many ways of configuring:</p>
<blockquote>
<div><ul class="simple">
<li>simple tweaks like port numbers in the meta model</li>
<li>more advanced tweaks, like jvm parameters, in the meta model (<tt class="docutils literal"><span class="pre">configTokens</span></tt> section)</li>
<li>configs roots which lets you add/delete/modify any file in the distributions that will be generated in Step 3</li>
<li>console plugins to extend/modify the behavior of the console</li>
</ul>
</div></blockquote>
<p>Check the documentation <a class="reference internal" href="glu-config.html"><em>configuring glu</em></a> for more details.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>If it is your first time deploying glu, the defaults are usually sensible and you should be good without tweaking anything.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Make sure though that you use a &#8216;real&#8217; database for production setups as is demonstrated in the sample production meta model.</p>
</div>
</div>
</div>
<div class="section" id="step-4-generate-the-distributions-d">
<span id="easy-production-setup-gen-dist"></span><h3>Step 4: Generate the distributions <tt class="docutils literal"><span class="pre">[-D]</span></tt><a class="headerlink" href="#step-4-generate-the-distributions-d" title="Permalink to this headline">¶</a></h3>
<p>Now that you have created your meta model, the setup tool will generate the set of distributions ready to be installed on the various hosts.</p>
<p>Issue the following command (see <a class="reference internal" href="#easy-production-setup-target-directory-tip"><em>tip</em></a> above on target directory):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; $GLU_HOME/bin/setup.sh -D &lt;path_to_meta_model&gt;
</pre></div>
</div>
<p>For example (using the sample meta model with the keys generated in Step 1):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; cd /tmp/prod-1
&gt; $GLU_HOME/bin/setup.sh -o distributions/staging -D models/staging-glu-meta-model.json.groovy
2013/07/11 09:49:19.235 INFO [SetupMain] Generating distributions
2013/07/11 09:49:21.702 INFO [GluPackager] Generated agent package file:/private/tmp/prod-1/distributions/staging/agents/org.linkedin.glu.agent-server-stgZkCluster-5.1.0/ =&gt; agent-host1:12906
2013/07/11 09:49:21.707 INFO [GluPackager] Skipped agent package file:/private/tmp/prod-1/distributions/staging/agents/org.linkedin.glu.agent-server-stgZkCluster-5.1.0/ =&gt; agent-host-2:12906
2013/07/11 09:49:21.709 INFO [GluPackager] Skipped agent package file:/private/tmp/prod-1/distributions/staging/agents/org.linkedin.glu.agent-server-stgZkCluster-5.1.0/ =&gt; agent-host3:12906
2013/07/11 09:49:31.642 INFO [GluPackager] Generated console package file:/private/tmp/prod-1/distributions/staging/consoles/org.linkedin.glu.console-server-stgConsole-5.1.0/ =&gt; console-host1:8080
2013/07/11 09:49:32.964 INFO [GluPackager] Generated ZooKeeper instance [1] file:/private/tmp/prod-1/distributions/staging/zookeeper-clusters/zookeeper-cluster-stgZkCluster/org.linkedin.zookeeper-server-zk-host1-2.0.0/ =&gt; zk-host1:2181
2013/07/11 09:49:32.965 INFO [GluPackager] Generated ZooKeeper instance [2] file:/private/tmp/prod-1/distributions/staging/zookeeper-clusters/zookeeper-cluster-stgZkCluster/org.linkedin.zookeeper-server-zk-host2-2.0.0/ =&gt; zk-host2:2181
2013/07/11 09:49:32.965 INFO [GluPackager] Generated ZooKeeper instance [3] file:/private/tmp/prod-1/distributions/staging/zookeeper-clusters/zookeeper-cluster-stgZkCluster/org.linkedin.zookeeper-server-zk-host3-2.0.0/ =&gt; zk-host3:2181
2013/07/11 09:49:32.965 INFO [GluPackager] Generated ZooKeeper cluster [stgZkCluster] file:/private/tmp/prod-1/distributions/staging/zookeeper-clusters/zookeeper-cluster-stgZkCluster/
2013/07/11 09:49:33.680 INFO [GluPackager] Generated agent cli package file:/private/tmp/prod-1/distributions/staging/agent-cli/org.linkedin.glu.agent-cli-5.1.0/
2013/07/11 09:49:33.709 INFO [GluPackager] Generated console cli package file:/private/tmp/prod-1/distributions/staging/console-cli/org.linkedin.glu.console-cli-5.1.0/
2013/07/11 09:49:33.725 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-zookeepers.sh
2013/07/11 09:49:33.729 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-agents.sh
2013/07/11 09:49:33.732 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-consoles.sh
2013/07/11 09:49:33.735 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-agent-cli.sh
2013/07/11 09:49:33.738 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-console-cli.sh
2013/07/11 09:49:33.741 INFO [GluPackager] Generated install script /private/tmp/prod-1/distributions/staging/bin/install-all.sh
2013/07/11 09:49:33.741 INFO [SetupMain] All distributions generated successfully.
</pre></div>
</div>
</div>
<div class="section" id="step-5-install-the-distributions">
<span id="easy-production-setup-install"></span><h3>Step 5: Install the distributions<a class="headerlink" href="#step-5-install-the-distributions" title="Permalink to this headline">¶</a></h3>
<p>All the distributions that were generated during Step 4 now need to be installed on each host. There are million different ways to install (and start) the distributions on each host:</p>
<blockquote>
<div><ul class="simple">
<li>building an image (solaris, vm, etc...) which contains the distributions</li>
<li>using chef</li>
<li>using scp</li>
<li>many many more...</li>
</ul>
</div></blockquote>
<p>Step 4 generates the distributions that are ready to be installed as-is and tell you where they are, and on which host to install them. Example:</p>
<div class="highlight-text"><div class="highlight"><pre>2013/07/11 09:49:32.964 INFO [GluPackager] Generated ZooKeeper instance [1] file:/private/tmp/prod-1/distributions/staging/zookeeper-clusters/zookeeper-cluster-stgZkCluster/org.linkedin.zookeeper-server-zk-host1-2.0.0/ =&gt; zk-host1:2181
</pre></div>
</div>
<p>Step 4 also generates a set of convenient install scripts using the information from the meta model (especially the <tt class="docutils literal"><span class="pre">host</span></tt> and <tt class="docutils literal"><span class="pre">install</span></tt> entries). The install scripts are convenient scripts that you can look at/tweak. They should work essentially as-is if you use <tt class="docutils literal"><span class="pre">scp</span></tt> (provided the fact that you already have the proper (ssh) credentials on the target host).</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The scripts use the variables <tt class="docutils literal"><span class="pre">SCP_CMD</span></tt>, <tt class="docutils literal"><span class="pre">SCP_OPTIONS</span></tt> and <tt class="docutils literal"><span class="pre">SCP_USER</span></tt> so you may want to override them to make the script behave differently. For example:</p>
<div class="highlight-text"><div class="highlight"><pre>SCP_CMD=&quot;echo scp&quot; distributions/staging/bin/install-all.sh
</pre></div>
</div>
<p class="last">will simply display what it would do without doing it.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">install-all.sh</span></tt> is essentially a script that combines all the others.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>The install script itself can also be part of the <a class="reference internal" href="glu-config.html#glu-config-setup-workflow"><em>template processing phase</em></a> that happens during the generation distribution and as a result you can also have your own:</p>
<div class="last highlight-text"><div class="highlight"><pre># create a file under /tmp/myFolder/config-templates/bin/install-@install.script.name@.sh.gtmpl
# the content of this file is a template which has access to the packagedArtifacts
# variable (see the one built-in)
# run the setup tool this way
$GLU_HOME/bin/setup.sh -D -o xxxx --config-templates-root &quot;&lt;default&gt;&quot; --config-templates-root /tmp/myFolder/config-templates my-model.json.groovy
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-6-configuring-zookeeper-z">
<span id="easy-production-setup-zookeeper"></span><h3>Step 6: Configuring ZooKeeper <tt class="docutils literal"><span class="pre">[-Z]</span></tt><a class="headerlink" href="#step-6-configuring-zookeeper-z" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although Step 4 generates a ZooKeeper distribution, if you already have a ZooKeeper cluster installed that you want to reuse, feel free to do so. There is nothing special about the ones that comes with glu except that the configuration (which is a bit hairy!) is done for you...</p>
</div>
<p>After installing all the components, start each ZooKeeper instance on each host where you have installed one (there are many ways to do this as well depending on your OS provisioning choices). But the ultimate command that needs to be run is:</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; /&lt;path to zookeeper instance install&gt;/bin/zookeeperctl.sh start
</pre></div>
</div>
<p>Once the cluster is up, you can now configure it which essentially means <em>uploading</em> the <tt class="docutils literal"><span class="pre">conf</span></tt> directory (that was created with the distribution under each ZooKeeper cluster) to ZooKeeper. For this you issue the command (see <a class="reference internal" href="#easy-production-setup-target-directory-tip"><em>tip</em></a> above on target directory):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; $GLU_HOME/bin/setup.sh -Z &lt;path_to_meta_model&gt;
</pre></div>
</div>
<p>For example (using the sample meta model with the keys generated in Step 1):</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; cd /tmp/prod-1
&gt; $GLU_HOME/bin/setup.sh -o distributions/staging -Z models/staging-glu-meta-model.json.groovy
2013/07/11 11:06:45.156 INFO [SetupMain] Configuring ZooKeeper clusters
2013/07/11 11:06:46.400 INFO [SetupMain] Configuring ZooKeeper cluster [stgZkCluster]
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The command you issue should be the same you did in Step 4 with <tt class="docutils literal"><span class="pre">-Z</span></tt> instead of <tt class="docutils literal"><span class="pre">-D</span></tt></p>
</div>
</div>
<div class="section" id="step-7-starting-the-agents">
<h3>Step 7: Starting the agents<a class="headerlink" href="#step-7-starting-the-agents" title="Permalink to this headline">¶</a></h3>
<p>You can now start the agents:</p>
<div class="highlight-text"><div class="highlight"><pre># for each agent
/&lt;path to agent install&gt;/bin/agentctl.sh start
</pre></div>
</div>
</div>
<div class="section" id="step-8-test-the-setup-so-far-optional">
<h3>Step 8: Test the setup so far (optional)<a class="headerlink" href="#step-8-test-the-setup-so-far-optional" title="Permalink to this headline">¶</a></h3>
<p>This optional step lets you check that everything is fine so far: the <tt class="docutils literal"><span class="pre">agent-cli</span></tt> that was generated part of the distribution should be able to talk to all the agents you have installed (and started). Issue the command:</p>
<div class="highlight-text"><div class="highlight"><pre>&gt; /&lt;path to outputFolder&gt;/agent-cli/org.linkedin.glu.agent-cli-&lt;version&gt;/bin/agent-cli.sh -s https://&lt;agent host&gt;:12906/ -m /
{&quot;mountPoints&quot;:[&quot;/&quot;]}
</pre></div>
</div>
</div>
<div class="section" id="step-9-start-the-console">
<h3>Step 9: Start the console<a class="headerlink" href="#step-9-start-the-console" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Prior to starting the console, you need to make sure that the database that it is going to use (which you defined in the meta model) is up and running and that the proper (database) user has been created. Check <a class="reference internal" href="console.html#console-configuration-database-mysql"><em>Example for a different database: MySql</em></a> for details for MySql.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">if you use the built-in HSQLDB, then you don&#8217;t have anything to do, but it is not recommended for production setup.</p>
</div>
</div>
<p>You can now start the console(s):</p>
<div class="highlight-text"><div class="highlight"><pre>/&lt;path to console install&gt;/bin/consolectl.sh start
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The first time you start the console, it will create an administrator user (<tt class="docutils literal"><span class="pre">admin</span></tt>/<tt class="docutils literal"><span class="pre">admin</span></tt>). It is <strong>strongly</strong> recommended to change the password immediately.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">During boostrap, the console will automatically create the fabrics that were defined in your meta model, so you are ready to go!</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The documentation is automatically available when you start the server, under <tt class="docutils literal"><span class="pre">http://&lt;consolehost&gt;:8080/glu/docs/html/index.html</span></tt></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you want to deploy the console in a different web application server then check the section <a class="reference internal" href="console.html#console-as-a-war"><em>Console as a war</em></a>.</p>
</div>
<p>You can now log in to the console using <tt class="docutils literal"><span class="pre">admin/admin</span></tt> for credentials and change the password.</p>
</div>
</div>
<div class="section" id="upgrade">
<h2>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h2>
<p>Check the <a class="reference internal" href="agent.html#agent-auto-upgrade"><em>section</em></a> on how to upgrade the agents.</p>
</div>
</div>


          </div>
        </div>
      </div>
</div>
<div class="sidebar">
  <div class="sidebar-entry">
    <h3>Table Of Contents</h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">What is glu?</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">A taste of glu (tutorial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html"> Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="glu-script.html"> glu script</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration-engine.html"> Orchestration engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="static-model.html"> Static Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html"> Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html"> Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta-model.html">Meta Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="glu-config.html">Configuring glu</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Easy Production Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-glu">Download glu</a></li>
<li class="toctree-l2"><a class="reference internal" href="#use-the-setup-tool">Use the setup tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="#easy-steps">Easy Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#detailed-steps">Detailed steps</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-1-generate-the-keys-k">Step 1: Generate the keys <tt class="docutils literal"><span class="pre">[-K]</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-create-your-own-meta-model">Step 2: Create your own meta-model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-configuring-glu-optional">Step 3: Configuring glu (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-generate-the-distributions-d">Step 4: Generate the distributions <tt class="docutils literal"><span class="pre">[-D]</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-install-the-distributions">Step 5: Install the distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-configuring-zookeeper-z">Step 6: Configuring ZooKeeper <tt class="docutils literal"><span class="pre">[-Z]</span></tt></a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-7-starting-the-agents">Step 7: Starting the agents</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-8-test-the-setup-so-far-optional">Step 8: Test the setup so far (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-9-start-the-console">Step 9: Start the console</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#upgrade">Upgrade</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="setup-tool.html"><tt class="docutils literal"><span class="pre">setup.sh</span></tt> tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="production-setup.html">Old Production Setup (prior to 5.1.0)</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup.html">Compiling glu</a></li>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration-guide.html">Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html">All content</a></li>
</ul>

  </div>
<div class="sidebar-entry">
  <h3>Quick Links</h3>
  <ul class="quick-links">
    <li><a href="https://bintray.com/pkg/show/general/pongasoft/glu/releases/">Download</a>
    <li><a href="tutorial.html">Tutorial</a>
    <li><a href="http://www.github.com/pongasoft/glu">Source Code</a>
    <li><a href="http://glu.977617.n3.nabble.com/">Forum / Questions / Help</a>
    <li><a href="http://devops.com/2011/07/09/glu-deployment-automation-video/">Video (July 2011)</a>
    <li><a href="https://plus.google.com/111352340806201326494" rel="publisher" style="text-decoration:none;">Google+<img src="https://ssl.gstatic.com/images/icons/gplus-32.png" alt="" style="border:0;width:16px;height:16px;margin:0;padding:0 0 0 .5em;vertical-align:middle"/></a>
    <li><a href="https://plus.google.com/communities/118019862679241960849">Google+ Community</a></li>
    <li><a href="http://twitter.com/glutweets">Twitter</a>
    <li><a href="https://github.com/pongasoft/glu/issues">Issues / Tasks</a>
    <li><a href="RELEASE.html">Latest Changes</a>
  </ul>
</div>
<div class="sidebar-entry">
  <h3>Technologies</h3>
  <ul class="quick-links">
    <li><a href="http://www.ej-technologies.com/products/jprofiler/overview.html">JProfiler</a>
  </ul>
</div>
  <div class="sidebar-entry">
    <h3>Twitter</h3>
    <script type="text/javascript">
      new TWTR.Widget({
                        version: 2,
                        type: 'profile',
                        rpp: 4,
                        interval: 6000,
                        width: 'auto',
                        height: 300,
                        theme: {
                          shell: {
                            background: '#dddddd',
                            color: '#000000'
                          },
                          tweets: {
                            background: '#ffffff',
                            color: '#000000',
                            links: '#ce5c00'
                          }
                        },
                        features: {
                          scrollbar: false,
                          loop: false,
                          live: false,
                          hashtags: true,
                          timestamp: true,
                          avatars: true,
                          behavior: 'all'
                        }
                      }).render().setUser('glutweets').start();
    </script>
  </div>
</div>
<div style="display:none">
   <a href="https://plus.google.com/111352340806201326494" rel="publisher">Google+</a>
</div>
<div class="clearer"></div>
</div>

</div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="glu-config.html" title="Configuring glu"
             >previous</a> |
          <a href="setup-tool.html" title="setup.sh tool"
             >next</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2011-2013, Yan Pujante.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>