

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Orchestration engine &mdash; glu 5.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="glu 5.0.0 documentation" href="index.html" />
    <link rel="next" title="Static Model" href="static-model.html" />
    <link rel="prev" title="glu script" href="glu-script.html" />
 
<link rel="stylesheet" href="_static/glu.css" type="text/css" />
<script type="text/javascript" src="http://widgets.twimg.com/j/2/widget.js"></script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-8362808-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="contents.html">
            <img class="logo" src="_static/glu-logo-214x72.png" alt="Logo"/>
          </a></p>
        <div class="headertitle"><a
          href="contents.html">glu 5.0.0 documentation</a></div>
        <div class="rel">
          <a href="glu-script.html" title="glu script"
             accesskey="P">previous</a> |
          <a href="static-model.html" title="Static Model"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

<div class="content-wrapper">
<div class="content">
<div class="document">
  
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="orchestration-engine-logo-orchestration-engine">
<h1><img alt="console logo" class="header-logo" src="_images/orchestration-engine-logo-86.png" /> Orchestration engine<a class="headerlink" href="#orchestration-engine-logo-orchestration-engine" title="Permalink to this headline">¶</a></h1>
<p>The orchestration engine is the heart of the whole system. Its responsibility is to listen to ZooKeeper events (coming from the glu agents), compute the <a class="reference internal" href="glossary.html#term-delta"><em class="xref std std-term">delta</em></a> and orchestrate the deployment plans.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently the orchestration engine is bundled with the console and is not running as a separate process. Please check the <a class="reference internal" href="console.html"><em>console</em></a> documentation regarding installation and configuration.</p>
</div>
<div class="section" id="key-components">
<h2>Key Components<a class="headerlink" href="#key-components" title="Permalink to this headline">¶</a></h2>
<img alt="orchestration engine key components" class="align-center" src="_images/goe-in-action-413.png" />
<div class="section" id="tracker-logo-tracker">
<span id="goe-tracker"></span><h3><img alt="tracker" class="header-logo" src="_images/tracker-logo-86.png" /> Tracker<a class="headerlink" href="#tracker-logo-tracker" title="Permalink to this headline">¶</a></h3>
<p>The role of the tracker is to listen to ZooKeeper events. Under the cover, the tracker uses <a class="reference external" href="http://zookeeper.apache.org/doc/r3.3.1/zookeeperOver.html#Conditional+updates+and+watches">ZooKeeper watches</a>. This makes the tracker very leightweight and efficient as it receives notifications only when something changes in the system.</p>
<p>For example, it gets notified immediately when:</p>
<ul class="simple">
<li>a new agent is added (case when a new node is added to the system)</li>
<li>an agent disappears (case when a node crashes or reboot for example)</li>
<li>a script state changes</li>
<li>...</li>
</ul>
<p>From the information collected (and updated real-time) by the tracker, the orchestration engine can compute the <a class="reference internal" href="#goe-live-model"><em>live model</em></a>.</p>
</div>
<div class="section" id="live-model-logo-live-model">
<span id="goe-live-model"></span><h3><img alt="live model" class="header-logo" src="_images/live-model-logo-86.png" /> Live Model<a class="headerlink" href="#live-model-logo-live-model" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="glossary.html#term-live-model"><em class="xref std std-term">live model</em></a> is computed by the orchestration engine from the information collected by the <a class="reference internal" href="#goe-tracker"><em>tracker</em></a>. The live model is the representation of the <a class="reference internal" href="glossary.html#term-live-state"><em class="xref std std-term">live state</em></a> which is used for computing the <a class="reference internal" href="#goe-delta"><em>delta</em></a>. Besides being used as an input to the <a class="reference internal" href="#goe-delta-service"><em>delta service</em></a> in order to compute the delta, the live model has several representation that you have access to:</p>
<div class="section" id="from-the-console">
<h4>From the console<a class="headerlink" href="#from-the-console" title="Permalink to this headline">¶</a></h4>
<p>If you navigate to an agent view page in the console, and for any given entry you click on the <tt class="docutils literal"><span class="pre">View</span> <span class="pre">Details</span></tt> (toggle), you will see something like this:</p>
<img alt="console entry detail" class="align-center" src="_images/goe-live-model-console-600.gif" />
<p>The information displayed here is exactly what the tracker has captured from ZooKeeper.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this screenshot you can even see how the script running on the remote agent has detected a failure and reported it. Thanks to ZooKeeper watches, the failure is propagated real-time and made available so that the user can fix the problem.</p>
</div>
</div>
<div class="section" id="from-the-command-line">
<h4>From the command line<a class="headerlink" href="#from-the-command-line" title="Permalink to this headline">¶</a></h4>
<p>From a shell terminal, you can issue:</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/console-cli.sh -f glu-dev-1 -u admin -x admin -b -l status
</pre></div>
</div>
<p>The important flag is <tt class="docutils literal"><span class="pre">-l</span></tt> which request the <em>live</em> model. You get an output very similar to the one in the console (more detailed though):</p>
<div class="highlight-text"><div class="highlight"><pre>{
  &quot;entries&quot;: [{
    &quot;agent&quot;: &quot;agent-1&quot;,
    &quot;initParameters&quot;: {
      &quot;port&quot;: 9000,
      &quot;skeleton&quot;: &quot;http://localhost:8080/glu/repository/tgzs/jetty-distribution-7.2.2.v20101205.tar.gz&quot;,
      &quot;webapps&quot;: [
        {
          &quot;contextPath&quot;: &quot;/cp1&quot;,
          &quot;monitor&quot;: &quot;/monitor&quot;,
          &quot;war&quot;: &quot;http://localhost:8080/glu/repository/wars/org.linkedin.glu.samples.sample-webapp-2.2.0.war&quot;
        },
        {
          &quot;contextPath&quot;: &quot;/cp2&quot;,
          &quot;monitor&quot;: &quot;/monitor&quot;,
          &quot;war&quot;: &quot;http://localhost:8080/glu/repository/wars/org.linkedin.glu.samples.sample-webapp-2.2.0.war&quot;
        }
      ]
    },
    &quot;metadata&quot;: {
      &quot;cluster&quot;: &quot;c1&quot;,
      &quot;container&quot;: {&quot;name&quot;: &quot;sample&quot;},
      &quot;currentState&quot;: &quot;stopped&quot;,
      &quot;error&quot;: &quot;Server down detected. Check the log file for errors.&quot;,
      &quot;modifiedTime&quot;: 1302883875857,
      &quot;product&quot;: &quot;product1&quot;,
      &quot;scriptState&quot;: {
        &quot;script&quot;: {
          &quot;gcLog&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/logs/gc.log&quot;,
          &quot;logsDir&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/logs/&quot;,
          &quot;port&quot;: 9000,
          &quot;serverCmd&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/bin/jetty-ctl.sh&quot;,
          &quot;serverLog&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/logs/start.log&quot;,
          &quot;serverRoot&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/&quot;,
          &quot;version&quot;: &quot;2.2.0&quot;,
          &quot;webapps&quot;: {
            &quot;/cp1&quot;: {
              &quot;context&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/contexts/_cp1.xml&quot;,
              &quot;contextPath&quot;: &quot;/cp1&quot;,
              &quot;localWar&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/wars/_cp1.war&quot;,
              &quot;monitor&quot;: &quot;/monitor&quot;,
              &quot;remoteWar&quot;: &quot;http://localhost:8080/glu/repository/wars/org.linkedin.glu.samples.sample-webapp-2.2.0.war&quot;
            },
            &quot;/cp2&quot;: {
              &quot;context&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/contexts/_cp2.xml&quot;,
              &quot;contextPath&quot;: &quot;/cp2&quot;,
              &quot;localWar&quot;: &quot;file:/export/content/glu/org.linkedin.glu.packaging-all-2.2.0/apps/sample/i001/wars/_cp2.war&quot;,
              &quot;monitor&quot;: &quot;/monitor&quot;,
              &quot;remoteWar&quot;: &quot;http://localhost:8080/glu/repository/wars/org.linkedin.glu.samples.sample-webapp-2.2.0.war&quot;
            }
          }
        },
        &quot;stateMachine&quot;: {
          &quot;currentState&quot;: &quot;stopped&quot;,
          &quot;error&quot;: &quot;Server down detected. Check the log file for errors.&quot;
        },
        &quot;timers&quot;: [{
          &quot;repeatFrequency&quot;: &quot;15s&quot;,
          &quot;timer&quot;: &quot;serverMonitor&quot;
        }]
      },
      &quot;version&quot;: &quot;1.0.0&quot;
    },
    &quot;mountPoint&quot;: &quot;/sample/i001&quot;,
    &quot;script&quot;: &quot;http://localhost:8080/glu/repository/scripts/org.linkedin.glu.script-jetty-2.2.0/JettyGluScript.groovy&quot;,
    &quot;tags&quot;: [
      &quot;frontend&quot;,
      &quot;osx&quot;,
      &quot;webapp&quot;
    ]
  }],
  &quot;fabric&quot;: &quot;glu-dev-1&quot;,
  &quot;metadata&quot;: {
    &quot;accuracy&quot;: &quot;ACCURATE&quot;,
    &quot;emptyAgents&quot;: []
  }
}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>without any filter (see <a class="reference internal" href="filtering.html"><em> Filtering</em></a>), you will get the entire model, not just the single entry. In order to select a single entry you can use the filter shortcut <tt class="docutils literal"><span class="pre">-I</span> <span class="pre">agent-1:/sample/i001</span></tt> like this:</p>
<div class="last highlight-text"><div class="highlight"><pre>./bin/console-cli.sh -f glu-dev-1 -u admin -x admin -b -l -I agent-1:/sample/i001 status
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="static-model-logo-static-model">
<span id="goe-static-model"></span><h3><img alt="static model" class="header-logo" src="_images/static-model-logo-86.png" /> Static Model<a class="headerlink" href="#static-model-logo-static-model" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="glossary.html#term-static-model"><em class="xref std std-term">static model</em></a> is an input to the orchestration engine. It describes the state of the entire system (for a given <a class="reference internal" href="glossary.html#term-fabric"><em class="xref std std-term">fabric</em></a>). The static model gets <em>loaded</em> in the orchestration engine either from the console web application, REST api or command line (<tt class="docutils literal"><span class="pre">-m</span></tt> option). Once loaded, the static model remains the <em>current</em> model until a new one is loaded.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Check out the separate entry about the <a class="reference internal" href="static-model.html"><em>static model</em></a> for more information.</p>
</div>
</div>
<div class="section" id="delta-service-logo-delta-service">
<span id="goe-delta-service"></span><h3><img alt="delta service" class="header-logo" src="_images/delta-service-logo-86.png" /> Delta Service<a class="headerlink" href="#delta-service-logo-delta-service" title="Permalink to this headline">¶</a></h3>
<p>The delta service is in charge of computing the <a class="reference internal" href="#goe-delta"><em>delta</em></a> between the <a class="reference internal" href="#goe-live-model"><em>live model</em></a> and the <a class="reference internal" href="#goe-static-model"><em>static model</em></a>. As mentionned previously, the static model used is the latest one that was loaded (or selected as current). The live model is coming from the <a class="reference internal" href="#goe-tracker"><em>tracker</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the event that there is an issue with the connection to ZooKeeper, the delta service will still be able to generate <em>deltas</em> but they will be flagged accordingly because the live model is no longer real-time. In the output of the <a class="reference internal" href="#goe-live-model"><em>live model</em></a> you can see this in action (in this case there was no problem):</p>
<div class="last highlight-text"><div class="highlight"><pre>&quot;metadata&quot;: {
  &quot;accuracy&quot;: &quot;ACCURATE&quot;,
  ...
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="delta-logo-delta">
<span id="goe-delta"></span><h3><img alt="delta" class="header-logo" src="_images/delta-logo-79.png" /> Delta<a class="headerlink" href="#delta-logo-delta" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="glossary.html#term-delta"><em class="xref std std-term">delta</em></a> is the result of the computation done by the <a class="reference internal" href="#goe-delta-service"><em>delta service</em></a>. The delta is fed into the <a class="reference internal" href="#goe-visualizer"><em>visualizer</em></a> and/or the <a class="reference internal" href="#goe-planner"><em>planner</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">At this moment, the delta is an internal concept not directly available but as it is driving the visualizer and planner, you have the ability to see different representations of it.</p>
</div>
</div>
<div class="section" id="visualizer-logo-visualizer">
<span id="goe-visualizer"></span><h3><img alt="visualizer" class="header-logo" src="_images/visualizer-logo-86.png" /> Visualizer<a class="headerlink" href="#visualizer-logo-visualizer" title="Permalink to this headline">¶</a></h3>
<p>The visualizer is in charge of turning the delta into a <em>visual</em> representation. This is represented in the console by the dashboard:</p>
<img alt="console dashboard" class="align-center" src="_images/goe-visualizer-dashboard.png" />
<p>In this screenshot which represents 3 applications deployed on 1 agent (coming from the <a class="reference internal" href="tutorial.html"><em>tutorial</em></a>) you can directly see the delta in action:</p>
<ul>
<li><p class="first">when a row is green (2nd row), it means that there is actually no delta: the static model and the live model are identical (or another way to say it, is that the desired state matches the live state)</p>
</li>
<li><dl class="first docutils">
<dt>when a row is red (1st and 3rd row), it means that there is a discrepancy between the static model and the live model. The last column (<tt class="docutils literal"><span class="pre">status</span></tt>) is giving more information about what kind of delta was detected:</dt>
<dd><ul class="first last simple">
<li>for row 1, the application is actually deployed but is not running (this is what you can see in the screenshot for the <a class="reference internal" href="#goe-live-model"><em>live model</em></a>): the entry appears in the live model but with a mismatching state</li>
<li>for row 3, the application is not deployed at all: the entry is totally absent from the live model</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="planner-logo-planner">
<span id="goe-planner"></span><h3><img alt="planner" class="header-logo" src="_images/planner-logo-86.png" /> Planner<a class="headerlink" href="#planner-logo-planner" title="Permalink to this headline">¶</a></h3>
<p>The planner is in charge of turning the delta into a <a class="reference internal" href="#goe-plan"><em>deployment plan</em></a>.</p>
</div>
<div class="section" id="plan-logo-deployment-plan">
<span id="goe-plan"></span><h3><img alt="plan" class="header-logo" src="_images/plan-logo-79.png" /> Deployment Plan<a class="headerlink" href="#plan-logo-deployment-plan" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="glossary.html#term-deployment-plan"><em class="xref std std-term">deployment plan</em></a> is the set of instructions (generated by the <a class="reference internal" href="#goe-planner"><em>planner</em></a>) which can be fed to the <a class="reference internal" href="#goe-deployer"><em>deployer</em></a> in order to <em>fix</em> the delta computed by the <a class="reference internal" href="#goe-delta-service"><em>delta service</em></a>. The idea is that if all instructions get executed successfully, then there won&#8217;t be any delta anymore.</p>
<p>An instruction is (usually) a call (using the secure REST api) to an agent to perform a particular action (as described in the section &#8220;<a class="reference internal" href="agent.html#agent-glu-script-engine"><em>glu Script Engine</em></a>&#8221;).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As mentionned in the <a class="reference internal" href="index.html"><em>What is glu?</em></a> section, the plan is <strong>never</strong> executed unless <strong>you</strong> give your explicit approval.</p>
</div>
<p>The deployment plan has several representations:</p>
<div class="section" id="id1">
<h4>From the Console<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Using the same delta you could visualize on the <a class="reference internal" href="#goe-visualizer"><em>dashboard</em></a>, the planner can compute various plans depending on what you instruct it to do.</p>
<p>From the console, you have the ability to</p>
<ul>
<li><p class="first">select a sequential plan:</p>
<img alt="console sequential plan" class="align-center" src="_images/goe-plan-sequential.png" />
</li>
<li><p class="first">select a parallel plan:</p>
<img alt="console parallel plan" class="align-center" src="_images/goe-plan-parallel.png" />
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the numbers in front of each instruction show you in which order they will be executed. A parallel plan will execute much faster than a sequential plan since the instructions will run in parallel so you don&#8217;t have to wait for previous instructions to complete. In a sequential plan, an error in an instruction will abort the entire remaining of the plan.</p>
</div>
</div>
<div class="section" id="id2">
<h4>From the Command Line<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>The exact same data is also available from the command line (hence the REST api):</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/console-cli.sh -f glu-dev-1 -u admin -x admin -a -n deploy
</pre></div>
</div>
<p>will produce the following output (sequential):</p>
<div class="highlight-text"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;plan name=&quot;origin=rest - action=deploy - filter=all - SEQUENTIAL&quot; fabric=&quot;glu-dev-1&quot;
      systemId=&quot;4836742aa34f6915fae3c0f46fbcc86ea381df74&quot; savedTime=&quot;1302892719254&quot;&gt;
  &lt;sequential origin=&quot;rest&quot; action=&quot;deploy&quot; filter=&quot;all&quot;&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/sample/i001&quot;&gt;
      &lt;leaf name=&quot;Start agent-1:/sample/i001 on agent-1&quot; /&gt;
    &lt;/sequential&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/sample/i003&quot;&gt;
      &lt;leaf name=&quot;Install script for installation agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Install agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Configure agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Start agent-1:/sample/i003 on agent-1&quot; /&gt;
    &lt;/sequential&gt;
  &lt;/sequential&gt;
&lt;/plan&gt;
</pre></div>
</div>
<p>And the command (<tt class="docutils literal"><span class="pre">-p</span></tt> means parallel):</p>
<div class="highlight-text"><div class="highlight"><pre>./bin/console-cli.sh -f glu-dev-1 -u admin -x admin -a -n -p deploy
</pre></div>
</div>
<p>will produce the following output (parallel):</p>
<div class="highlight-text"><div class="highlight"><pre>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;plan name=&quot;origin=rest - action=deploy - filter=all - PARALLEL&quot; fabric=&quot;glu-dev-1&quot;
      systemId=&quot;4836742aa34f6915fae3c0f46fbcc86ea381df74&quot; savedTime=&quot;1302892859008&quot;&gt;
  &lt;parallel origin=&quot;rest&quot; action=&quot;deploy&quot; filter=&quot;all&quot;&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/sample/i001&quot;&gt;
      &lt;leaf name=&quot;Start agent-1:/sample/i001 on agent-1&quot; /&gt;
    &lt;/sequential&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/sample/i003&quot;&gt;
      &lt;leaf name=&quot;Install script for installation agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Install agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Configure agent-1:/sample/i003 on agent-1&quot; /&gt;
      &lt;leaf name=&quot;Start agent-1:/sample/i003 on agent-1&quot; /&gt;
    &lt;/sequential&gt;
  &lt;/parallel&gt;
&lt;/plan&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">-n</span></tt> option means <em>dry-run</em> and it allows you to display the deployment plan instead of executing it!</p>
</div>
</div>
</div>
<div class="section" id="deployer-logo-deployer">
<span id="goe-deployer"></span><h3><img alt="planner" class="header-logo" src="_images/deployer-logo-86.png" /> Deployer<a class="headerlink" href="#deployer-logo-deployer" title="Permalink to this headline">¶</a></h3>
<p>The deployer is responsible to execute the <a class="reference internal" href="#goe-plan"><em>deployment plan</em></a> computed by the <a class="reference internal" href="#goe-planner"><em>planner</em></a>. The deployer knows how to deploy arbitrarily complex deployment plans (sequential / parallel nested at any level) and reports its progress as it goes along, allowing the very dynamic view available in the console:</p>
<img alt="deployer in action" class="align-center" src="_images/goe-deployer-in-action.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">as you can see on the screenshot, every running action can be cancelled in the event there is a need for it.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>the command line is also using the reporting capabilities of the deployer to display a progress bar:</p>
<img alt="plan progress from the cli" class="last align-center" src="_images/tutorial-plan-progress-cli.png" />
</div>
</div>
</div>
<div class="section" id="rest-api">
<span id="goe-rest-api"></span><h2>REST api<a class="headerlink" href="#rest-api" title="Permalink to this headline">¶</a></h2>
<p>The orchestration engine offers a REST api (served by the console webapp).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You do not have to use the REST api directly: there is a convenient <a class="reference internal" href="#goe-cli"><em>command line interface (cli)</em></a> which is already using it. You would use the REST api directly, in cases when the cli is not enough or you want to have more control for example.</p>
</div>
<div class="section" id="security-authorization">
<h3>Security / Authorization<a class="headerlink" href="#security-authorization" title="Permalink to this headline">¶</a></h3>
<p>The security model is simply implementing http basic authorization: every request needs to come with an <tt class="docutils literal"><span class="pre">Authorization</span></tt> header with the following format:</p>
<div class="highlight-text"><div class="highlight"><pre>Authorization: Basic &lt;base64(username:password)&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The username and password are only slightly obfuscated (base 64) but it is not an issue because the cli talks to the console over https and as a result the headers are never traveling over an insecure channel.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You can change the way authentication and authorization are handled entirely by writing your own plugin!</p>
</div>
</div>
<div class="section" id="a-few-concepts">
<h3>A few concepts<a class="headerlink" href="#a-few-concepts" title="Permalink to this headline">¶</a></h3>
<p>You may wonder what is the difference between the 3 notions exposed by the REST API: plans, current deployments and archived deployments.</p>
<ul>
<li><p class="first">A plan (as exposed by the <tt class="docutils literal"><span class="pre">/plans*</span></tt> APIs) simply represents a list of instructions that glu <em>will</em> execute. If you use the console, you can get a good idea of what a plan looks like:</p>
<blockquote>
<div><img alt="Dashboard shows the delta" class="align-center" src="_images/tutorial-select-plan-2.png" />
</div></blockquote>
<p>Currently a plan only lives (for a short time) in memory, between the time it gets created (<tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plans</span></tt>) and the time it gets executed. There is no persistent storage.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this may change in the future as it would be convenient to create a plan just once and execute it at a later time or repeatedly.</p>
</div>
</li>
<li><p class="first">Once the plan is created and you execute it (<tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plan/&lt;planId&gt;/execution</span></tt>), it becomes a deployment and 2 things happen:</p>
<ol class="arabic simple">
<li>a memory representation of the deployment is created: the current deployment</li>
<li>a database entry is created for this deployment: the archived deployment</li>
</ol>
</li>
<li><p class="first">The current deployment lives in memory because it is used by the orchestration engine to execute the steps that needs to happen. It is dynamically updated as steps complete. The current deployment will remain in memory (even after it completes) until either you shutdown the console (so the memory is gone...) or you archive it. The current deployment contains more details than the archived one and can be seen in the console when clicking on the <cite>Plans</cite> tab.</p>
</li>
<li><p class="first">The archived deployment is created (in the database) when the plan starts executing and then it is updated again <strong>only</strong> when the current deployment completes (whether it was successful or not). The archived deployment is permanent (because it is stored in the database) and can be seen in the console when clicking on the <cite>Plans/Archived</cite> tab.</p>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>There is a relationship between a plan execution and the current and archived plan: the <tt class="docutils literal"><span class="pre">executionId</span></tt> is in fact the
<tt class="docutils literal"><span class="pre">deploymentId</span></tt>:</p>
<div class="last highlight-text"><div class="highlight"><pre>GET /plans/&lt;planId&gt;/executions/&lt;executionId&gt;

is equivalent to

GET /deployment/current/&lt;executionId&gt;

and if you want to access the archived version you can issue

GET /deployment/archived/&lt;executionId&gt;
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Currently, the <tt class="docutils literal"><span class="pre">/plans*</span></tt> APIs are only dealing with the plans that have been created through the REST API. The plans created and executed from the web interface use a different mechanism and won&#8217;t appear in those calls. This will be adressed in an upcoming release. The <tt class="docutils literal"><span class="pre">/deployments*</span></tt> calls work whether the REST API or the web interface was used.</p>
</div>
</div>
<div class="section" id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h3>
<p>Main URI: <tt class="docutils literal"><span class="pre">/console/rest/v1/&lt;fabric&gt;</span></tt> (all the URIs in the following table start with the main URI)</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="33%" />
<col width="26%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">URI</th>
<th class="head">Description</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td>None</td>
<td>Returns details for fabric</td>
<td><a class="reference internal" href="#goe-rest-api-get-fabric"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PUT</span></tt></td>
<td>None</td>
<td>Add/Update a fabric</td>
<td><a class="reference internal" href="#goe-rest-api-put-fabric"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td>None</td>
<td>Delete a fabric</td>
<td><a class="reference internal" href="#goe-rest-api-delete-fabric"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">HEAD</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agents</span></tt></td>
<td>Returns the number of agents</td>
<td><a class="reference internal" href="#goe-rest-api-head-agents"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agents</span></tt></td>
<td>List all the agents</td>
<td><a class="reference internal" href="#goe-rest-api-get-agents"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agent/&lt;agentName&gt;</span></tt></td>
<td>View details about the agent</td>
<td><a class="reference internal" href="#goe-rest-api-get-agent"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agent/&lt;agentName&gt;</span></tt></td>
<td>Remove all knowledge of an agent</td>
<td><a class="reference internal" href="#goe-rest-api-delete-agent"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PUT</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agent/&lt;agentName&gt;/fabric</span></tt></td>
<td>Sets the fabric for the agent</td>
<td><a class="reference internal" href="#goe-rest-api-put-agent-fabric"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agent/&lt;agentName&gt;/fabric</span></tt></td>
<td>Clears the fabric for the agent</td>
<td><a class="reference internal" href="#goe-rest-api-delete-agent-fabric"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agents/versions</span></tt></td>
<td>List all the agents versions</td>
<td><a class="reference internal" href="#goe-rest-api-get-agents-versions"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">POST</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agents/versions</span></tt></td>
<td>Upgrade the agents</td>
<td><a class="reference internal" href="#goe-rest-api-post-agents-versions"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plans</span></tt></td>
<td>List all the plans</td>
<td><a class="reference internal" href="#goe-rest-api-get-plans"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">POST</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plans</span></tt></td>
<td>Create a plan</td>
<td><a class="reference internal" href="#goe-rest-api-post-plans"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;</span></tt></td>
<td>View the plan (as an xml document)</td>
<td><a class="reference internal" href="#goe-rest-api-get-plan"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">POST</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/execution</span></tt></td>
<td>Executes the plan</td>
<td><a class="reference internal" href="#goe-rest-api-post-plan-execution"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/executions</span></tt></td>
<td>List all the executions for a plan</td>
<td><a class="reference internal" href="#goe-rest-api-get-plan-executions"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">HEAD</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt></td>
<td>Returns the status of the
execution</td>
<td><a class="reference internal" href="#goe-rest-api-head-plan-execution"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt></td>
<td>Returns the execution as an xml
document</td>
<td><a class="reference internal" href="#goe-rest-api-get-plan-execution"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt></td>
<td>Aborts the execution</td>
<td><a class="reference internal" href="#goe-rest-api-delete-plan-execution"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployments/current</span></tt></td>
<td>List all current deployments</td>
<td><a class="reference internal" href="#goe-rest-api-get-deployments-current"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployments/current</span></tt></td>
<td>Archive all current deployments</td>
<td><a class="reference internal" href="#goe-rest-api-delete-deployments-current"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></td>
<td>View details about the current
deployment</td>
<td><a class="reference internal" href="#goe-rest-api-get-deployment-current"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">HEAD</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></td>
<td>View info only about the current
deployment</td>
<td><a class="reference internal" href="#goe-rest-api-head-deployment-current"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">DELETE</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></td>
<td>Archive the current deployment</td>
<td><a class="reference internal" href="#goe-rest-api-delete-deployment-current"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">HEAD</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployments/archived</span></tt></td>
<td>Returns the total count of
archived deployments</td>
<td><a class="reference internal" href="#goe-rest-api-head-deployments-archived"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployments/archived</span></tt></td>
<td>List the archived deployments
(paginated!)</td>
<td><a class="reference internal" href="#goe-rest-api-get-deployments-archived"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">HEAD</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployment/archived/&lt;deploymentId&gt;</span></tt></td>
<td>View info about the archived
deployment</td>
<td><a class="reference internal" href="#goe-rest-api-head-deployment-archived"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/deployment/archived/&lt;deploymentId&gt;</span></tt></td>
<td>View details about the archived
deployment</td>
<td><a class="reference internal" href="#goe-rest-api-get-deployment-archived"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">POST</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/model/static</span></tt></td>
<td>Loads the (desired) model in the
console</td>
<td><a class="reference internal" href="#goe-rest-api-post-model-static"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/model/static</span></tt></td>
<td>Retrieves the current loaded model
(aka &#8216;desired&#8217; state)</td>
<td><a class="reference internal" href="#goe-rest-api-get-model-static"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/model/live</span></tt></td>
<td>Retrieves the current live model
coming from ZooKeeper (aka current
state)</td>
<td><a class="reference internal" href="#goe-rest-api-get-model-live"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/model/delta</span></tt></td>
<td>Retrieves the delta between static
model and live model</td>
<td><a class="reference internal" href="#goe-rest-api-get-model-delta"><em>view</em></a></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">POST</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agent/&lt;agentName&gt;/commands</span></tt></td>
<td>Executes a shell command</td>
<td><a class="reference internal" href="#goe-rest-api-post-command-execute"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/command/&lt;commandId&gt;/streams</span></tt></td>
<td>Retrieves the streams (=result)
of the command execution</td>
<td><a class="reference internal" href="#goe-rest-api-get-command-streams"><em>view</em></a></td>
</tr>
</tbody>
</table>
<p>Any fabric related URI: <tt class="docutils literal"><span class="pre">/console/rest/v1/-</span></tt> (all the URIs in the following table start with this URI)</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="33%" />
<col width="26%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">URI</th>
<th class="head">Description</th>
<th class="head">Details</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/</span></tt></td>
<td>Returns the list of fabrics</td>
<td><a class="reference internal" href="#goe-rest-api-get-fabrics"><em>view</em></a></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">GET</span></tt></td>
<td><tt class="docutils literal"><span class="pre">/agents</span></tt></td>
<td>Returns the map of associations
agent -&gt; fabric</td>
<td><a class="reference internal" href="#goe-rest-api-get-agents-fabrics"><em>view</em></a></td>
</tr>
</tbody>
</table>
<div class="section" id="fabric-details">
<span id="goe-rest-api-get-fabric"></span><h4>Fabric details<a class="headerlink" href="#fabric-details" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Retrieve the details about the fabric</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>body: json map with the details of the fabric</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such fabric</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
{
  &quot;color&quot;: &quot;#005a87&quot;,
  &quot;name&quot;: &quot;glu-dev-1&quot;,
  &quot;zkConnectString&quot;: &quot;localhost:2181&quot;,
  &quot;zkSessionTimeout&quot;: &quot;30s&quot;
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="add-update-a-fabric">
<span id="goe-rest-api-put-fabric"></span><h4>Add/Update a fabric<a class="headerlink" href="#add-update-a-fabric" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Add (or update if already exists) a fabric</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">PUT</span></tt></p>
<p>request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">zkConnectString=localhost:2181</span></tt> the connection string to your ZooKeeper setup</li>
<li><tt class="docutils literal"><span class="pre">zkSessionTimeout=30s</span></tt> the timeout for ZooKeeper sessions</li>
<li><tt class="docutils literal"><span class="pre">color=%23ff00ff</span></tt> the color (for the ui top navigation bar), can be anything that is useable as a color in css (ex of valid input: <tt class="docutils literal"><span class="pre">red</span></tt>, <tt class="docutils literal"><span class="pre">#ff00ff</span></tt> (which must be properly query string encoded =&gt; <tt class="docutils literal"><span class="pre">#</span></tt> gets encoded into <tt class="docutils literal"><span class="pre">%23</span></tt>))</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) when the update was successful</li>
<li><tt class="docutils literal"><span class="pre">400</span></tt> (<tt class="docutils literal"><span class="pre">BAD</span> <span class="pre">REQUEST</span></tt>) when the parameters are not valid (body will contain details about the error)</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; -X PUT &quot;http://localhost:8080/console/rest/v1/glu-dev-3?zkConnectString=localhost:2181&amp;zkSessionTimeout=30s&amp;color=%23ff00ff&quot;
&gt; PUT /console/rest/v1/glu-dev-3?zkConnectString=localhost:2181&amp;zkSessionTimeout=30s&amp;color=%23ff00ff HTTP/1.1
&lt; HTTP/1.1 200 OK
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="delete-a-fabric">
<span id="goe-rest-api-delete-fabric"></span><h4>Delete a fabric<a class="headerlink" href="#delete-a-fabric" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Delete a fabric</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">DELETE</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) when the delete was successful</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when the fabric was already deleted</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; -X DELETE &quot;http://localhost:8080/console/rest/v1/glu-dev-3&quot;
&gt; DELETE /console/rest/v1/glu-dev-3 HTTP/1.1
&lt; HTTP/1.1 200 OK
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="agents-count">
<span id="goe-rest-api-head-agents"></span><h4>Agents count<a class="headerlink" href="#agents-count" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Returns the number of agents (in the fabric specified in the URL)</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/agents</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> with the number of agents</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no agent</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agents&quot; --head
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 4
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-all-the-agents">
<span id="goe-rest-api-get-agents"></span><h4>List all the agents<a class="headerlink" href="#list-all-the-agents" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all the agents</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/agents</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> with the number of agents</li>
<li>body: json map where key is agent name and value is another map with all the agents properties (as can be seen in the console when looking at an individual agent and clicking <cite>View Details</cite>).</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no agent</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agents?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 4
{
  &quot;agent-1&quot;: {
    &quot;glu.agent.apps&quot;: &quot;/export/content/glu/devsetup/apps/agent-1&quot;,
    &quot;glu.agent.configURL&quot;: &quot;zookeeper:/org/glu/agents/fabrics/glu-dev-1/config/config.properties&quot;,
    &quot;glu.agent.dataDir&quot;: &quot;/export/content/glu/devsetup/agent-1/data&quot;,
    &quot;glu.agent.fabric&quot;: &quot;glu-dev-1&quot;,
    ...
    &quot;viewURL&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/agent-1&quot;
  },
  &quot;agent-10&quot;: {
    ...
    &quot;viewURL&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/agent-10&quot;
  },
  ...
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-agent-details">
<span id="goe-rest-api-get-agent"></span><h4>View agent details<a class="headerlink" href="#view-agent-details" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: View the details of a single agent</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/agent/&lt;agentName&gt;</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>body: json map with a single key <tt class="docutils literal"><span class="pre">details</span></tt> containing another map with all the agents properties (as can be seen in the console when looking at an individual agent and clicking <cite>View Details</cite>).
.. note:: In an upcoming release there will be other keys in the map to represent also the entries deployed on the agent (as can be seen in the console when looking at an individual agent)</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such agent</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre> curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/agent-1?prettyPrint=true&quot;
 &lt; HTTP/1.1 200 OK
 {&quot;details&quot;: {
   &quot;glu.agent.apps&quot;: &quot;/export/content/glu/devsetup/apps/agent-1&quot;,
   &quot;glu.agent.configURL&quot;: &quot;zookeeper:/org/glu/agents/fabrics/glu-dev-1/config/config.properties&quot;,
   &quot;glu.agent.dataDir&quot;: &quot;/export/content/glu/devsetup/agent-1/data&quot;,
   &quot;glu.agent.fabric&quot;: &quot;glu-dev-1&quot;,
   &quot;glu.agent.homeDir&quot;: &quot;/export/content/glu/devsetup/agent-1&quot;,
   &quot;glu.agent.hostname&quot;: &quot;192.168.0.150&quot;,
   &quot;glu.agent.hostnameFactory&quot;: &quot;:ip&quot;,
   &quot;glu.agent.keystoreChecksum&quot;: &quot;JSHZAn5IQfBVp1sy0PgA36fT_fD&quot;,
   &quot;glu.agent.keystorePath&quot;: &quot;zookeeper:/org/glu/agents/fabrics/glu-dev-1/config/agent.keystore&quot;,
   &quot;glu.agent.logDir&quot;: &quot;/export/content/glu/devsetup/agent-1/data/logs&quot;,
   &quot;glu.agent.name&quot;: &quot;agent-1&quot;,
   &quot;glu.agent.persistent.properties&quot;: &quot;/export/content/glu/devsetup/agent-1/data/config/agent.properties&quot;,
   &quot;glu.agent.pid&quot;: &quot;4641&quot;,
   &quot;glu.agent.port&quot;: &quot;13906&quot;,
   &quot;glu.agent.rest.nonSecure.port&quot;: &quot;12907&quot;,
   &quot;glu.agent.rest.server.defaultThreads&quot;: &quot;3&quot;,
   &quot;glu.agent.scriptRootDir&quot;: &quot;/export/content/glu/devsetup/apps/agent-1&quot;,
   &quot;glu.agent.scriptStateDir&quot;: &quot;/export/content/glu/devsetup/agent-1/data/scripts/state&quot;,
   &quot;glu.agent.sslEnabled&quot;: &quot;true&quot;,
   &quot;glu.agent.tempDir&quot;: &quot;/export/content/glu/devsetup/agent-1/data/tmp&quot;,
   &quot;glu.agent.truststoreChecksum&quot;: &quot;qUFMIePiJhz8i7Ow9lZmN5pyZjl&quot;,
   &quot;glu.agent.truststorePath&quot;: &quot;zookeeper:/org/glu/agents/fabrics/glu-dev-1/config/console.truststore&quot;,
   &quot;glu.agent.version&quot;: &quot;3.2.0-SNAPSHOT&quot;,
   &quot;glu.agent.zkConnectString&quot;: &quot;localhost:2181&quot;,
   &quot;glu.agent.zkProperties&quot;: &quot;/export/content/glu/devsetup/agent-1/data/config/zk.properties&quot;,
   &quot;glu.agent.zkSessionTimeout&quot;: &quot;5s&quot;,
   &quot;glu.agent.zookeeper.root&quot;: &quot;/org/glu&quot;
}}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="remove-all-knowledge-of-an-agent">
<span id="goe-rest-api-delete-agent"></span><h4>Remove all knowledge of an agent<a class="headerlink" href="#remove-all-knowledge-of-an-agent" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: This call should be used in the scenario when you want to <cite>decommission</cite> a node: all data stored in ZooKeeper in regards to this agent will be wiped out.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/agent/&lt;agentName&gt;</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) if the agent was succesfully cleaned</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) if the agent did not exist in the first place</li>
<li><tt class="docutils literal"><span class="pre">409</span></tt> (<tt class="docutils literal"><span class="pre">CONFLICT</span></tt>) if the agent is still up and running!</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; -X DELETE &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/agent-1&quot;
&gt; DELETE /console/rest/v1/glu-dev-1/agent/agent-1 HTTP/1.1
&lt; HTTP/1.1 200 OK
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="assign-a-fabric-to-an-agent">
<span id="goe-rest-api-put-agent-fabric"></span><h4>Assign a fabric to an agent<a class="headerlink" href="#assign-a-fabric-to-an-agent" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Assigns a fabric to an agent (and optionally configures it)</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">PUT</span> <span class="pre">/agent/&lt;agentName&gt;/fabric</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">host=&lt;ip</span> <span class="pre">or</span> <span class="pre">hostname&gt;</span></tt> for configuring the agent using the ip or the hostname of the agent (this assumes that the configuration port is <tt class="docutils literal"><span class="pre">12907</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">uri=&lt;configuration</span> <span class="pre">uri&gt;</span></tt> for configuring the agent using the given uri (this form allows you to use a different port (ex: <tt class="docutils literal"><span class="pre">http://x.x.x.x:13906/config</span></tt>))</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">400</span></tt> (<tt class="docutils literal"><span class="pre">BAD</span> <span class="pre">REQUEST</span></tt>) if missing or unknown fabric</li>
<li><tt class="docutils literal"><span class="pre">409</span></tt> (<tt class="docutils literal"><span class="pre">CONFLICT</span></tt>) when the configuration phase failed</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; -X PUT &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/xeon/fabric?host=127.0.0.1&quot;
&lt; HTTP/1.1 200 OK
</pre></div>
</div>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>&#8220;Configuring&#8221; the agent means that the orchestration engine will issue a REST call to the agent with its own ZooKeeper connect string as configuration. This allows the use case where the agent is started without a ZooKeeper at all, so the agent is simply waiting for somebody to tell it where is his ZooKeeper.
This is what you see in the agent log:</p>
<div class="last highlight-text"><div class="highlight"><pre>Waiting for glu.agent.zkConnectString (rest:put:http://xeon.local:12907)
</pre></div>
</div>
</div>
</div>
<div class="section" id="clears-the-fabric-for-an-agent">
<span id="goe-rest-api-delete-agent-fabric"></span><h4>Clears the fabric for an agent<a class="headerlink" href="#clears-the-fabric-for-an-agent" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Simply clears the fabric previously associated to an agent</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/agent/&lt;agentName&gt;/fabric</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) if it worked</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) if there was already no fabric</li>
<li><tt class="docutils literal"><span class="pre">400</span></tt> (<tt class="docutils literal"><span class="pre">BAD</span> <span class="pre">REQUEST</span></tt>) if missing or unknown fabric</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; -X DELETE &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/xeon/fabric&quot;
&lt; HTTP/1.1 200 OK
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-all-the-agents-versions">
<span id="goe-rest-api-get-agents-versions"></span><h4>List all the agents versions<a class="headerlink" href="#list-all-the-agents-versions" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all the agents versions</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/agents/versions</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> with the number of agents</li>
<li>body: json map where key is agent name and value is the agent version</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no agent</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre> curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agents/versions?prettyPrint=true&quot;
 &lt; HTTP/1.1 200 OK
 &lt; X-glu-count: 4
 {
   &quot;agent-1&quot;: &quot;3.2.0&quot;,
   &quot;agent-10&quot;: &quot;3.1.0&quot;,
   &quot;agent-4&quot;: &quot;3.2.0&quot;,
   &quot;agent-7&quot;: &quot;3.2.0&quot;
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="upgrade-the-agents">
<span id="goe-rest-api-post-agents-versions"></span><h4>Upgrade the agents<a class="headerlink" href="#upgrade-the-agents" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Description: Create a plan to upgrade the agents. You must then execute the plan as described in <a class="reference internal" href="#goe-rest-api-post-plan-execution"><em>Executing a plan</em></a></li>
<li>Request: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/agents/versions</span></tt></li>
</ul>
<blockquote>
<div><ul class="simple">
<li>The post content type should be <tt class="docutils literal"><span class="pre">application/x-www-form-urlencoded</span></tt></li>
<li>The body of the post should be a well formed query string containing the following parameters:<ul>
<li><tt class="docutils literal"><span class="pre">version</span></tt>: the version of the new agent</li>
<li><tt class="docutils literal"><span class="pre">coordinates</span></tt>: the url of the agent upgrade tarball</li>
<li><tt class="docutils literal"><span class="pre">agents</span></tt>: 1 per agent name you want to upgrade</li>
</ul>
</li>
</ul>
</div></blockquote>
<ul>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">201</span></tt> (<tt class="docutils literal"><span class="pre">Created</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">Location</span></tt> containing the url to POST to in order to execute the plan (see <a class="reference internal" href="#goe-rest-api-post-plan-execution"><em>Executing a plan</em></a>)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is nothing to do</li>
<li><tt class="docutils literal"><span class="pre">400</span></tt> (<tt class="docutils literal"><span class="pre">BAD</span> <span class="pre">REQUEST</span></tt>) when missing <tt class="docutils literal"><span class="pre">version</span></tt> or <tt class="docutils literal"><span class="pre">coordinates</span></tt></li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre># 1. create the upgrade plan
curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agents/versions&quot; --data &quot;agents=agent-1&amp;agents=agent-4&amp;version=3.1.0&amp;coordinates=https://github.com/downloads/linkedin/glu/org.linkedin.glu.agent-server-upgrade-3.1.0.tgz&quot;
&gt; Content-Type: application/x-www-form-urlencoded
&gt;
&lt; HTTP/1.1 201 Created
&lt; Location: http://localhost:8080/console/rest/v1/glu-dev-1/plan/49e69ef4-7c84-4f9b-9838-fce131b69028

# 2. view the upgrade plan. You can then execute it...
curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/plan/49e69ef4-7c84-4f9b-9838-fce131b69028?prettyPrint=true&quot;
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;plan fabric=&quot;glu-dev-1&quot; id=&quot;49e69ef4-7c84-4f9b-9838-fce131b69028&quot; origin=&quot;rest&quot; action=&quot;upgradeAgents&quot; version=&quot;3.1.0&quot; name=&quot;origin=rest - action=upgradeAgents - version=3.1.0 - PARALLEL&quot; savedTime=&quot;1312126425812&quot;&gt;
  &lt;parallel origin=&quot;rest&quot; action=&quot;upgradeAgents&quot; version=&quot;3.1.0&quot;&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/self/upgrade&quot;&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; initParameters=&quot;{agentTar=https://github.com/downloads/linkedin/glu/org.linkedin.glu.agent-server-upgrade-3.1.0.tgz, newVersion=3.1.0}&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Install script for [/self/upgrade] on [agent-1]&quot; script=&quot;{scriptClassName=org.linkedin.glu.agent.impl.script.AutoUpgradeScript}&quot; scriptLifecycle=&quot;installScript&quot; /&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [install] phase for [/self/upgrade] on [agent-1]&quot; scriptAction=&quot;install&quot; toState=&quot;installed&quot; /&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [prepare] phase for [/self/upgrade] on [agent-1]&quot; scriptAction=&quot;prepare&quot; toState=&quot;prepared&quot; /&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [commit] phase for [/self/upgrade] on [agent-1]&quot; scriptAction=&quot;commit&quot; toState=&quot;upgraded&quot; /&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [uninstall] phase for [/self/upgrade] on [agent-1]&quot; scriptAction=&quot;uninstall&quot; toState=&quot;NONE&quot; /&gt;
      &lt;leaf agent=&quot;agent-1&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Uninstall script for [/self/upgrade] on [agent-1]&quot; scriptLifecycle=&quot;uninstallScript&quot; /&gt;
    &lt;/sequential&gt;
    &lt;sequential agent=&quot;agent-4&quot; mountPoint=&quot;/self/upgrade&quot;&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; initParameters=&quot;{agentTar=https://github.com/downloads/linkedin/glu/org.linkedin.glu.agent-server-upgrade-3.1.0.tgz, newVersion=3.1.0}&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Install script for [/self/upgrade] on [agent-4]&quot; script=&quot;{scriptClassName=org.linkedin.glu.agent.impl.script.AutoUpgradeScript}&quot; scriptLifecycle=&quot;installScript&quot; /&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [install] phase for [/self/upgrade] on [agent-4]&quot; scriptAction=&quot;install&quot; toState=&quot;installed&quot; /&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [prepare] phase for [/self/upgrade] on [agent-4]&quot; scriptAction=&quot;prepare&quot; toState=&quot;prepared&quot; /&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [commit] phase for [/self/upgrade] on [agent-4]&quot; scriptAction=&quot;commit&quot; toState=&quot;upgraded&quot; /&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Run [uninstall] phase for [/self/upgrade] on [agent-4]&quot; scriptAction=&quot;uninstall&quot; toState=&quot;NONE&quot; /&gt;
      &lt;leaf agent=&quot;agent-4&quot; fabric=&quot;glu-dev-1&quot; mountPoint=&quot;/self/upgrade&quot; name=&quot;Uninstall script for [/self/upgrade] on [agent-4]&quot; scriptLifecycle=&quot;uninstallScript&quot; /&gt;
    &lt;/sequential&gt;
  &lt;/parallel&gt;
&lt;/plan&gt;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-all-the-plans">
<span id="goe-rest-api-get-plans"></span><h4>List all the plans<a class="headerlink" href="#list-all-the-plans" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all the plans (that have been created through <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plans</span></tt>).</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/plans</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> =&gt; number of plans</li>
<li>body: json map where key is plan id and value is a link to view it</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no plan to list</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/plans?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 2
&lt; Content-Type: text/json
&lt; Content-Length: 262
{
  &quot;03714d11-7b44-4717-b426-85d4cbf6c5d4&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/plan/03714d11-7b44-4717-b426-85d4cbf6c5d4&quot;,
  &quot;b553f8de-62bc-4000-9c43-2fe869bdb3c4&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/plan/b553f8de-62bc-4000-9c43-2fe869bdb3c4&quot;
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="create-deployment-plan">
<span id="goe-rest-api-post-plans"></span><h4>Create deployment plan<a class="headerlink" href="#create-deployment-plan" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Create a plan.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plans</span></tt></p>
<ul class="simple">
<li>view details <a class="reference internal" href="#goe-rest-api-representing-a-plan"><em>below</em></a> for the content of body of the <tt class="docutils literal"><span class="pre">POST</span></tt></li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">201</span></tt> (<tt class="docutils literal"><span class="pre">CREATED</span></tt>) with <tt class="docutils literal"><span class="pre">Location</span></tt> header to access the plan (<tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when no plan created because there is nothing to do</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; --data &quot;state=stopped&amp;planType=transition&quot; http://localhost:8080/console/rest/v1/glu-dev-1/plans
&gt; POST /console/rest/v1/glu-dev-1/plans HTTP/1.1
&gt; Authorization: Basic Z2x1YTpwYXNzd29yZA==
&gt; Content-Length: 33
&gt; Content-Type: application/x-www-form-urlencoded
&gt;
&lt; HTTP/1.1 201 Created
&lt; Location: http://localhost:8080/console/rest/v1/glu-dev-1/plan/8283e25e-f68d-4bbd-8a71-5149f23466ec
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-a-deployment-plan">
<span id="goe-rest-api-get-plan"></span><h4>View a deployment plan<a class="headerlink" href="#view-a-deployment-plan" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Description: View the plan (as an xml document)</li>
<li>Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/plan</span></tt><ul>
<li>N/A</li>
</ul>
</li>
<li>Response:<ul>
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with an xml representation of the plan</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT_FOUND</span></tt>) if no such plan</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="execute-a-deployment-plan">
<span id="goe-rest-api-post-plan-execution"></span><h4>Execute a deployment plan<a class="headerlink" href="#execute-a-deployment-plan" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Execute the plan.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plan/&lt;planId&gt;/execution</span></tt></p>
<ul class="simple">
<li>N/A</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">201</span></tt> (<tt class="docutils literal"><span class="pre">CREATED</span></tt>) with <tt class="docutils literal"><span class="pre">Location</span></tt> header to access the plan execution (<tt class="docutils literal"><span class="pre">/plan/&lt;planId&gt;/</span> <span class="pre">execution/&lt;executionId&gt;</span></tt>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">it is a non blocking call and it returns right away and you can check the progress thus allowing to have a progress bar!</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT_FOUND</span></tt>) if no such plan</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="list-all-the-plan-executions">
<span id="goe-rest-api-get-plan-executions"></span><h4>List all the plan executions<a class="headerlink" href="#list-all-the-plan-executions" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all the plan excutions. Once a plan has been created (<tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/plans</span></tt>) it is possible to execute it multiple times. This call allows you to list all the executions of a previously created plan.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/plan/&lt;planId&gt;/executions</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> =&gt; number of executions</li>
<li>body: json map where key is execution id and value is a link to view it</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when no execution</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre> curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/plan/03714d11-7b44-4717-b426-85d4cbf6c5d4/executions&quot;
 &lt; HTTP/1.1 200 OK
 &lt; X-glu-count: 1
 &lt; Content-Type: text/json
 &lt;
{&quot;3&quot;:&quot;http://localhost:8080/console/rest/v1/glu-dev-1/plan/03714d11-7b44-4717-b426-85d4cbf6c5d4/execution/3&quot;}
</pre></div>
</div>
</li>
</ul>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The execution id is in fact a deployment id and can be used directly in the <tt class="docutils literal"><span class="pre">/deployments*</span></tt> APIs</p>
</div>
</div>
<div class="section" id="check-status-of-plan-execution">
<span id="goe-rest-api-head-plan-execution"></span><h4>Check status of plan execution<a class="headerlink" href="#check-status-of-plan-execution" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Description: Return the status of the execution.</li>
<li>Request: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt><ul>
<li>N/A</li>
</ul>
</li>
<li>Response:<ul>
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with <tt class="docutils literal"><span class="pre">X-glu-completion</span></tt> header with value:<ol class="loweralpha">
<li>if plan non completed, percentage completion (ex: <tt class="docutils literal"><span class="pre">87</span></tt>)</li>
<li>if completed: <tt class="docutils literal"><span class="pre">100:&lt;completion</span> <span class="pre">status&gt;</span></tt> (ex: <tt class="docutils literal"><span class="pre">100:FAILED</span></tt> or <tt class="docutils literal"><span class="pre">100:COMPLETED</span></tt>)</li>
</ol>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT_FOUND</span></tt>) if no such execution</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="view-execution-plan">
<span id="goe-rest-api-get-plan-execution"></span><h4>View execution plan<a class="headerlink" href="#view-execution-plan" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Description: Return the execution as an xml document.</li>
<li>Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt><ul>
<li>N/A</li>
</ul>
</li>
<li>Response:<ul>
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with an xml representation of the execution (equivalent to the view in the console)</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT_FOUND</span></tt>) if no such execution</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="abort-execution-plan">
<span id="goe-rest-api-delete-plan-execution"></span><h4>Abort execution plan<a class="headerlink" href="#abort-execution-plan" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Description: Abort the execution.</li>
<li>Request: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/plan/&lt;planId&gt;/execution/&lt;executionId&gt;</span></tt><ul>
<li>N/A</li>
</ul>
</li>
<li>Response:<ul>
<li>TBD</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="list-all-current-deployments">
<span id="goe-rest-api-get-deployments-current"></span><h4>List all current deployments<a class="headerlink" href="#list-all-current-deployments" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all current deployments.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/deployments/current</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> =&gt; number of current deployments</li>
<li>body: json map where key is deployment id and value is another map with some details about the deployment (equivalent to what you see on the <cite>Plans</cite> tab in the console)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no deployment to list</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployments/current?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 4
&lt; Content-Type: text/json
{
  &quot;1&quot;: {
    &quot;completedSteps&quot;: 16,
    &quot;description&quot;: &quot;Deploy - Fabric [glu-dev-1] - PARALLEL&quot;,
    &quot;endTime&quot;: 1312038165459,
    &quot;startTime&quot;: 1312038160946,
    &quot;status&quot;: &quot;COMPLETED&quot;,
    &quot;totalSteps&quot;: 16,
    &quot;username&quot;: &quot;glua&quot;,
    &quot;viewURL&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/current/1&quot;
  },
  ...
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="archive-all-current-deployments">
<span id="goe-rest-api-delete-deployments-current"></span><h4>Archive all current deployments<a class="headerlink" href="#archive-all-current-deployments" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Archive all current deployments.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/deployments/current</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-archived</span></tt> =&gt; number of deployments that were archived</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -X DELETE -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployments/current&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-archived: 3
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-current-deployment-details">
<span id="goe-rest-api-get-deployment-current"></span><h4>View current deployment (details)<a class="headerlink" href="#view-current-deployment-details" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: View the current deployment details</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-startTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-endTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-username</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-status</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-description</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-completedSteps</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-totalSteps</span></tt></li>
<li>body: xml representation of the plan showing the details</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such deployment</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/current/1?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-startTime: 1312038160946
&lt; X-glu-endTime: 1312038165459
&lt; X-glu-username: glua
&lt; X-glu-status: COMPLETED
&lt; X-glu-description: Deploy - Fabric [glu-dev-1] - PARALLEL
&lt; X-glu-completedSteps: 16
&lt; X-glu-totalSteps: 16
&lt; Content-Type: text/xml
&lt;
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;plan fabric=&quot;glu-dev-1&quot; systemId=&quot;47d37bb288b3908f2f3fe5d8b382053e7b13719b&quot; id=&quot;f84e4f59-476d-4c17-bf3d-534b975cebf1&quot; name=&quot;Deploy - Fabric [glu-dev-1] - PARALLEL&quot;&gt;
  &lt;parallel name=&quot;Deploy - Fabric [glu-dev-1] - PARALLEL&quot;&gt;
    &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/m1/i001&quot;&gt;
  ...
&lt;/plan&gt;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-current-deployment-info">
<span id="goe-rest-api-head-deployment-current"></span><h4>View current deployment (info)<a class="headerlink" href="#view-current-deployment-info" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: View the current deployment info (just the headers).</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-startTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-endTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-username</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-status</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-description</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-completedSteps</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-totalSteps</span></tt></li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such deployment</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v --head -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/current/1&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-startTime: 1312038160946
&lt; X-glu-endTime: 1312038165459
&lt; X-glu-username: glua
&lt; X-glu-status: COMPLETED
&lt; X-glu-description: Deploy - Fabric [glu-dev-1] - PARALLEL
&lt; X-glu-completedSteps: 16
&lt; X-glu-totalSteps: 16
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="archive-current-deployment">
<span id="goe-rest-api-delete-deployment-current"></span><h4>Archive current deployment<a class="headerlink" href="#archive-current-deployment" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Archive a single current deployment.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">/deployment/current/&lt;deploymentId&gt;</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-archived</span></tt> =&gt; <tt class="docutils literal"><span class="pre">true</span></tt> if the deployment was archived, <tt class="docutils literal"><span class="pre">false</span></tt> if already archived</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -X DELETE -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/current/1&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-archived: true
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="archived-deployments-count">
<span id="goe-rest-api-head-deployments-archived"></span><h4>Archived deployments count<a class="headerlink" href="#archived-deployments-count" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Return the total count of archived deployments.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/deployments/archived</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-totalCount</span></tt></li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v --head -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployments/archived&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-totalCount: 4
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-archived-deployments-paginated">
<span id="goe-rest-api-get-deployments-archived"></span><h4>List archived deployments (paginated)<a class="headerlink" href="#list-archived-deployments-paginated" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List archived deployments according to the parameters provided to determine which <cite>page</cite> to return.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/deployments/archived</span></tt></p>
<p>optional request parameters:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">max=xxx</span></tt> how many entries to return max (max cannot exceed a limit which defaults to 25 which is also the value used if not provided)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">offset=xxx</span></tt> which entry to start (default is 0)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">offset</span></tt> represents the index in the list (not a deployment id!). To go from page to page, the offset simply increments by <tt class="docutils literal"><span class="pre">max</span></tt>. Example with <tt class="docutils literal"><span class="pre">max=10</span></tt>, <tt class="docutils literal"><span class="pre">offset=0</span></tt> will return page 1, <tt class="docutils literal"><span class="pre">offset=10</span></tt> will return page 2, etc...</p>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">sort</span></tt> which <cite>column</cite> to sort on (default is <tt class="docutils literal"><span class="pre">startDate</span></tt>)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">order</span></tt> which order to sort the list (default is <tt class="docutils literal"><span class="pre">desc</span></tt>)</p>
</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-max</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-offset</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-sort</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-order</span></tt>, which are the values provided/defaulted/adjusted from the request and <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> which is the number of entries returned and <tt class="docutils literal"><span class="pre">X-glu-totalCount</span></tt> which is the total number of archived deployments</li>
<li>body: json map where key is deployment id and value is another map with some details about the deployment (equivalent to what you see on the <cite>Plans/Archived</cite> tab in the console)</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO</span> <span class="pre">CONTENT</span></tt>) when there is no deployment to list</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployments/archived?prettyPrint=true&amp;max=2&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 2
&lt; X-glu-totalCount: 4
&lt; X-glu-max: 2
&lt; X-glu-offset: 0
&lt; X-glu-sort: startDate
&lt; X-glu-order: desc
&lt; Content-Type: text/json
{
  &quot;3&quot;: {
    &quot;description&quot;: &quot;origin=rest - action=bounce - filter=all - SEQUENTIAL&quot;,
    &quot;endTime&quot;: 1312039222813,
    &quot;startTime&quot;: 1312039220934,
    &quot;status&quot;: &quot;COMPLETED&quot;,
    &quot;username&quot;: &quot;glua&quot;,
    &quot;viewURL&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/archived/3&quot;
  },
  &quot;4&quot;: {
    &quot;description&quot;: &quot;origin=rest - action=bounce - filter=all - PARALLEL&quot;,
    &quot;endTime&quot;: 1312039238723,
    &quot;startTime&quot;: 1312039237598,
    &quot;status&quot;: &quot;COMPLETED&quot;,
    &quot;username&quot;: &quot;glua&quot;,
    &quot;viewURL&quot;: &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/archived/4&quot;
  }
}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-archived-deployment-details">
<span id="goe-rest-api-get-deployment-archived"></span><h4>View archived deployment (details)<a class="headerlink" href="#view-archived-deployment-details" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: View the archived deployment details</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/deployment/archived/&lt;deploymentId&gt;</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-startTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-endTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-username</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-status</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-description</span></tt></li>
<li>body: xml representation of the plan showing the details</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such deployment</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre> curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/archived/1?prettyPrint=true&quot;
 &lt; HTTP/1.1 200 OK
 &lt; X-glu-startTime: 1312038160946
 &lt; X-glu-endTime: 1312038165459
 &lt; X-glu-username: glua
 &lt; X-glu-status: COMPLETED
 &lt; X-glu-description: Deploy - Fabric [glu-dev-1] - PARALLEL
&lt; Content-Type: text/xml
 &lt;
 &lt;?xml version=&quot;1.0&quot;?&gt;
 &lt;plan fabric=&quot;glu-dev-1&quot; systemId=&quot;47d37bb288b3908f2f3fe5d8b382053e7b13719b&quot; id=&quot;f84e4f59-476d-4c17-bf3d-534b975cebf1&quot; name=&quot;Deploy - Fabric [glu-dev-1] - PARALLEL&quot;&gt;
   &lt;parallel name=&quot;Deploy - Fabric [glu-dev-1] - PARALLEL&quot;&gt;
     &lt;sequential agent=&quot;agent-1&quot; mountPoint=&quot;/m1/i001&quot;&gt;
   ...
 &lt;/plan&gt;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="view-archived-deployment-info">
<span id="goe-rest-api-head-deployment-archived"></span><h4>View archived deployment (info)<a class="headerlink" href="#view-archived-deployment-info" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: View the archived deployment info (just the headers).</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">HEAD</span> <span class="pre">/deployment/archived/&lt;deploymentId&gt;</span></tt></p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-startTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-endTime</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-username</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-status</span></tt>, <tt class="docutils literal"><span class="pre">X-glu-description</span></tt></li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">FOUND</span></tt>) when there is no such deployment</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v --head -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/deployment/archived/1&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-startTime: 1312038160946
&lt; X-glu-endTime: 1312038165459
&lt; X-glu-username: glua
&lt; X-glu-status: COMPLETED
&lt; X-glu-description: Deploy - Fabric [glu-dev-1] - PARALLEL
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="load-static-model">
<span id="goe-rest-api-post-model-static"></span><h4>Load static model<a class="headerlink" href="#load-static-model" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Load the (desired) model in the console.</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/model/static</span></tt></p>
<p>Body can be of 2 types depending on the <tt class="docutils literal"><span class="pre">Content-Type</span></tt> header:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">application/x-www-form-urlencoded</span></tt> then body should contain <tt class="docutils literal"><span class="pre">modelUrl=xxx</span></tt> with the url pointing to the model (the console will &#8216;download&#8217; it)</li>
<li><tt class="docutils literal"><span class="pre">text/json</span></tt> then body should be the model itself (<a class="reference external" href="https://gist.github.com/755981">example</a>)</li>
</ol>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">201</span></tt> (<tt class="docutils literal"><span class="pre">CREATED</span></tt>) when loaded successfully</li>
<li><tt class="docutils literal"><span class="pre">204</span></tt> (<tt class="docutils literal"><span class="pre">NO_CONTENT</span></tt>) if model was loaded successfully and is equal to the previous one</li>
<li><tt class="docutils literal"><span class="pre">400</span></tt> (<tt class="docutils literal"><span class="pre">BAD_REQUEST</span></tt>) if the model is not valid (should be a properly json formatted document)</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">NOT_FOUND</span></tt>) when error (note error handling needs to be revisited)</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="view-static-model">
<span id="goe-rest-api-get-model-static"></span><h4>View static model<a class="headerlink" href="#view-static-model" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Retrieve the current loaded model (aka <em>expected</em> state).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">this is what you loaded using <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/model/static</span></tt></p>
</div>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/model/static</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
<li><tt class="docutils literal"><span class="pre">systemFilter=...</span></tt> for filtering (see <a class="reference internal" href="filtering.html#goe-filter-syntax"><em>Filter syntax</em></a> for the syntax)</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with a json representation of the model</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="view-live-model">
<span id="goe-rest-api-get-model-live"></span><h4>View live model<a class="headerlink" href="#view-live-model" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Retrieve the current live model coming from ZooKeeper (aka <em>current</em> state).</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/model/live</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
<li><tt class="docutils literal"><span class="pre">systemFilter=...</span></tt> for filtering (see <a class="reference internal" href="filtering.html#goe-filter-syntax"><em>Filter syntax</em></a> for the syntax)</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with a json representation of the live model</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">the metadata contains information like <tt class="docutils literal"><span class="pre">currentState</span></tt></p>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="view-delta">
<span id="goe-rest-api-get-model-delta"></span><h4>View delta<a class="headerlink" href="#view-delta" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Retrieve the delta (similar to what can be seen on the dashboard) which is the difference between the static and live model (expected vs current)</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/model/delta</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
<li><tt class="docutils literal"><span class="pre">systemFilter=...</span></tt> for filtering (see <a class="reference internal" href="filtering.html#goe-filter-syntax"><em>Filter syntax</em></a> for the syntax)</li>
<li><tt class="docutils literal"><span class="pre">errorsOnly=true</span></tt> filter to show only errors</li>
<li><tt class="docutils literal"><span class="pre">flatten=true</span></tt> flatten the output (similar to dashboard view)</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with a <a class="reference internal" href="#goe-rest-api-delta-formal-definition"><em>json representation</em></a> of the delta</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="list-all-the-fabrics">
<span id="goe-rest-api-get-fabrics"></span><h4>List all the fabrics<a class="headerlink" href="#list-all-the-fabrics" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: List all the fabrics</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> with the number of fabrics</li>
<li>body: json array of fabric names</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/-?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 2
&lt; Content-Type: text/json
[
  &quot;glu-dev-1&quot;,
  &quot;glu-dev-2&quot;
]
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-all-the-agents-fabrics">
<span id="goe-rest-api-get-agents-fabrics"></span><h4>List all the agents fabrics<a class="headerlink" href="#list-all-the-agents-fabrics" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Returns the map of association agent -&gt; fabric</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/agents</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">prettyPrint=true</span></tt> for human readable output</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-count</span></tt> with the number of entries in the map</li>
<li>body: json map where the key is agent name and the value is the fabric</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/-/agents?prettyPrint=true&quot;
&lt; HTTP/1.1 200 OK
&lt; X-glu-count: 2
&lt; Content-Type: text/json
{
  &quot;agent-1&quot;: &quot;glu-dev-1&quot;,
  &quot;xeon.local&quot;: &quot;glu-dev-1&quot;
}
</pre></div>
</div>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This api (<tt class="docutils literal"><span class="pre">/rest/v1/-/agents</span></tt>) which returns a map of association agent -&gt; fabric should not be mistaken with the api <tt class="docutils literal"><span class="pre">/rest/v1/&lt;fabric&gt;/agents</span></tt> which specifies the fabric and list all agents in a given fabric!</p>
</div>
</div>
<div class="section" id="execute-a-shell-command">
<span id="goe-rest-api-post-command-execute"></span><h4>Execute a shell command<a class="headerlink" href="#execute-a-shell-command" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Description: Execute a shell command on the agent. Note that this call is non blocking and return right away. In order to wait for the command to complete and read the result of the command, you need to use the <a class="reference internal" href="#goe-rest-api-get-command-streams"><em>other api</em></a></p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">POST</span> <span class="pre">/agent/&lt;agentName&gt;/commands</span></tt></p>
<p>required request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">command=...</span></tt>: the command to execute (ex: <tt class="docutils literal"><span class="pre">uptime</span></tt>)</li>
</ul>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">type=shell</span></tt> the type of command to run (at this moment only <tt class="docutils literal"><span class="pre">shell</span></tt> is supported)</li>
<li><tt class="docutils literal"><span class="pre">redirectStderr=true</span></tt> whether stderr should be redirected to stdout (default to <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
</ul>
<p>optional input stream: if you want to provide <tt class="docutils literal"><span class="pre">stdin</span></tt> to your command, simply put it in the body of the post</p>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">201</span></tt> (<tt class="docutils literal"><span class="pre">Created</span></tt>) with:<ul>
<li>headers: <tt class="docutils literal"><span class="pre">X-glu-command-id</span></tt> the id of the command created</li>
<li>body: json map containing the same id</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">Not</span> <span class="pre">found</span></tt>) if no such agent</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/agent/agent-1/commands?command=cat%20-&quot; -H &quot;Content-Type: application/octet-stream&quot; --data-binary &#39;abcdef&#39;
&gt; POST /console/rest/v1/glu-dev-1/agent/agent-1/commands?command=cat%20- HTTP/1.1
&gt; ...
&gt; Content-Type: application/octet-stream
&gt; Content-Length: 6
&gt;
* upload completely sent off: 6 out of 6 bytes
&lt; HTTP/1.1 201 Created
&lt; ...
&lt; X-glu-command-id: 13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536
&lt; Content-Type: text/json
&lt; Content-Length: 57
&lt;
{&quot;id&quot;:&quot;13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536&quot;}
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="read-wait-for-command-result">
<span id="goe-rest-api-get-command-streams"></span><h4>Read/Wait for command result<a class="headerlink" href="#read-wait-for-command-result" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Once a command has been started, this api will retrieve the result(s) and optionally wait. If you request more than one stream, then you will get a muliplexed stream of results (the format is fairly simple and you can take a look at the java code on how to demultiplex it. TODO: add python code for demultiplexing/example).</p>
</li>
<li><p class="first">Request: <tt class="docutils literal"><span class="pre">GET</span> <span class="pre">/commands/&lt;commandId&gt;/streams</span></tt></p>
<p>optional request parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">stdoutStream=true</span></tt> include stdout stream (default: <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stdoutOffset=...</span></tt> where to start in stdout stream in number of bytes (negative number counts backward) (default: <tt class="docutils literal"><span class="pre">0</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stdoutLen=...</span></tt> how many bytes max to read for stdout (default: <tt class="docutils literal"><span class="pre">-1</span></tt> =&gt; read all)</li>
<li><tt class="docutils literal"><span class="pre">stderrStream=true</span></tt> include stderr stream (default: <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stderrOffset=...</span></tt> where to start in stderr stream in number of bytes (negative number counts backward) (default: <tt class="docutils literal"><span class="pre">0</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stderrLen=...</span></tt> how many bytes max to read for stderr (default: <tt class="docutils literal"><span class="pre">-1</span></tt> =&gt; read all)</li>
<li><tt class="docutils literal"><span class="pre">stdinStream=true</span></tt> include stdin stream (default: <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stdinOffset=...</span></tt> where to start in stdin stream in number of bytes (negative number counts backward) (default: <tt class="docutils literal"><span class="pre">0</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">stdinLen=...</span></tt> how many bytes max to read for stdin (default: <tt class="docutils literal"><span class="pre">-1</span></tt> =&gt; read all)</li>
<li><tt class="docutils literal"><span class="pre">exitValueStream=true</span></tt> include the exit value (which is what the shell command returned: <tt class="docutils literal"><span class="pre">$?</span></tt>) (default: <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">exitValueStreamTimeout=...</span></tt> if the command is not completed yet, how long to wait (meaning block) until the result is returned (0 means wait until completed). Can be any timespan (ex: <tt class="docutils literal"><span class="pre">5s</span></tt>, <tt class="docutils literal"><span class="pre">10m</span></tt>, <tt class="docutils literal"><span class="pre">50</span></tt> for 50 milliseconds) (default: don&#8217;t wait!)</li>
<li><tt class="docutils literal"><span class="pre">exitErrorStream=true</span></tt> include the error stream (when an exception is generated for any reason, usually communication) (default: <tt class="docutils literal"><span class="pre">false</span></tt>)</li>
</ul>
</li>
<li><p class="first">Response:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">200</span></tt> (<tt class="docutils literal"><span class="pre">OK</span></tt>) with:<ul>
<li>headers:<ul>
<li><tt class="docutils literal"><span class="pre">X-glu-command-id</span></tt> the id of the command</li>
<li><tt class="docutils literal"><span class="pre">X-glu-command-startTime</span></tt> the time when the command was started</li>
<li><tt class="docutils literal"><span class="pre">X-glu-command-completionTime</span></tt> the time when the command was completed (if completed)</li>
</ul>
</li>
<li>body: the stream(s) requested</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">404</span></tt> (<tt class="docutils literal"><span class="pre">Not</span> <span class="pre">found</span></tt>) if no such command</li>
</ul>
</li>
<li><p class="first">Example:</p>
<div class="highlight-text"><div class="highlight"><pre>curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/command/13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536/streams?stdoutStream=true&quot;
&gt; GET /console/rest/v1/glu-dev-1/command/13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536/streams?stdoutStream=true HTTP/1.1
&gt; ...
&gt;
&lt; HTTP/1.1 200 OK
&lt; X-glu-command-id: 13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536
&lt; X-glu-command-startTime: 1353009232768
&lt; X-glu-command-completionTime: 1353009232917
&lt; Content-Type: application/octet-stream
&lt; ...
&lt;
abcdef

curl -v -u &quot;glua:password&quot; &quot;http://localhost:8080/console/rest/v1/glu-dev-1/command/13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536/streams?stdoutStream=true&amp;exitValueStream=true&quot;
&gt; GET /console/rest/v1/glu-dev-1/command/13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536/streams?stdoutStream=true&amp;exitValueStream=true HTTP/1.1
&gt; ...
&gt;
&lt; HTTP/1.1 200 OK
&lt; X-glu-command-id: 13b05a27b80-d527ccf3-166a-4986-90b2-41be8c2ba536
&lt; X-glu-command-startTime: 1353009232768
&lt; X-glu-command-completionTime: 1353009232917
&lt; Content-Type: application/octet-stream
&lt; ...
&lt;
MISV1.0=V=O

V=1
0

O=6
abcdef
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="api-examples">
<h3>API Examples<a class="headerlink" href="#api-examples" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Sending the model to glu in <a class="reference external" href="https://gist.github.com/756465">java</a></li>
<li><a class="reference external" href="https://github.com/pongasoft/glu/blob/REL_1.5.0/console/org.linkedin.glu.console-cli/src/cmdline/resources/lib/python/gluconsole/rest.py">Python example</a> (part of the cli)</li>
</ul>
</div>
</div>
<div class="section" id="delta-formal-definition">
<span id="goe-rest-api-delta-formal-definition"></span><h2>Delta Formal Definition<a class="headerlink" href="#delta-formal-definition" title="Permalink to this headline">¶</a></h2>
<p>TBD: add formal delta definition</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the meantime, you may want to check this <a class="reference external" href="http://glu.977617.n3.nabble.com/formal-definition-of-a-delta-td4024766.html">forum thread</a></p>
</div>
</div>
<div class="section" id="representing-a-plan">
<span id="goe-rest-api-representing-a-plan"></span><h2>Representing a plan<a class="headerlink" href="#representing-a-plan" title="Permalink to this headline">¶</a></h2>
<div class="section" id="query-string-based">
<h3>Query String based<a class="headerlink" href="#query-string-based" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">POST</span></tt> you issue must be of Content-Type <tt class="docutils literal"><span class="pre">application/x-www-form-urlencoded</span></tt></p>
<p>The body then contains a query string with the following parameters:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="19%" />
<col width="17%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>name</td>
<td>value</td>
<td>required</td>
<td>example</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">planAction</span></tt></td>
<td><tt class="docutils literal"><span class="pre">start</span></tt>, <tt class="docutils literal"><span class="pre">stop</span></tt>,
<tt class="docutils literal"><span class="pre">bounce</span></tt>,
<tt class="docutils literal"><span class="pre">deploy</span></tt>,
<tt class="docutils literal"><span class="pre">undeploy</span></tt>,
<tt class="docutils literal"><span class="pre">redeploy</span></tt></td>
<td>One of
<tt class="docutils literal"><span class="pre">planAction</span></tt> or
<tt class="docutils literal"><span class="pre">planType</span></tt></td>
<td><tt class="docutils literal"><span class="pre">planAction=start</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">planType</span></tt></td>
<td><tt class="docutils literal"><span class="pre">deploy</span></tt>,
<tt class="docutils literal"><span class="pre">undeploy</span></tt>,
<tt class="docutils literal"><span class="pre">redeploy</span></tt>,
<tt class="docutils literal"><span class="pre">bounce</span></tt>,
<tt class="docutils literal"><span class="pre">transition</span></tt> or
anything custom</td>
<td>One of
<tt class="docutils literal"><span class="pre">planAction</span></tt> or
<tt class="docutils literal"><span class="pre">planType</span></tt></td>
<td><tt class="docutils literal"><span class="pre">planType=transition&amp;state=stopped</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">systemFilter</span></tt></td>
<td>a system filter as
described in the
previous section
(remember that it
<strong>must</strong> be properly
url encoded.</td>
<td>No. It simply means
don&#8217;t filter at all.</td>
<td><tt class="docutils literal"><span class="pre">systemFilter=and%7bagent%3d'ei2-app3-zone5.qa'%7d</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">order</span></tt></td>
<td><tt class="docutils literal"><span class="pre">parallel</span></tt> or
<tt class="docutils literal"><span class="pre">sequential</span></tt></td>
<td>No. Default to
<tt class="docutils literal"><span class="pre">sequential</span></tt></td>
<td><tt class="docutils literal"><span class="pre">order=parallel</span></tt></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">planAction=stop</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">planType=transition&amp;state=stopped</span></tt>. The <tt class="docutils literal"><span class="pre">planType</span></tt> notation is more generic and should be used when using your own state machine or creating your own custom plan types (in which case you can also pass as many parameters as you want).</p>
</div>
</div>
</div>
<div class="section" id="json-dsl-based">
<h2>Json/DSL Based<a class="headerlink" href="#json-dsl-based" title="Permalink to this headline">¶</a></h2>
<p>Coming soon</p>
</div>
<div class="section" id="plugins">
<span id="goe-plugins"></span><h2>Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h2>
<p>The orchestration engine offers a plugin mechanism which allows you to hook into some specific phases to tweak and/or change the behavior. For example, the <tt class="docutils literal"><span class="pre">UserService_pre_authenticate</span></tt> hook allows you to bypass entirely the login/authentication mechanism that comes built-in and instead provide your own.</p>
<div class="section" id="what-is-a-plugin">
<h3>What is a plugin?<a class="headerlink" href="#what-is-a-plugin" title="Permalink to this headline">¶</a></h3>
<p>A plugin is simply a class with (groovy) closures, each of them defining a specific hook. You can define as many or as little of those closures as you want and you can <em>spread</em> them accross different classes (for example, you can have a plugin class handling only the <em>deployment</em> related plugin hooks, and another handling the hooks for a different part of the system). If a closure is missing, then it will simply not be called.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">The class <a class="reference external" href="https://github.com/pongasoft/glu/tree/master/orchestration/org.linkedin.glu.orchestration-engine/src/main/groovy/org/linkedin/glu/orchestration/engine/plugins/builtin/DocumentationPlugin.groovy">DocumentationPlugin</a> is meant to be an hexaustive list of all the hooks available as well as a documentation on how to use them. It also serves as an example of how to write a plugin!</p>
</div>
</div>
<div class="section" id="how-do-you-install-a-plugin">
<h3>How do you install a plugin?<a class="headerlink" href="#how-do-you-install-a-plugin" title="Permalink to this headline">¶</a></h3>
<p>The orchestration engine is currently bundled in the console web application. In order to install your plugins(s), you need to package them as jar file(s) and make sure they are available in the classpath of your web server. If you deploy the console as the provided console server, then simply drop your plugins (jar files) in the <tt class="docutils literal"><span class="pre">glu/repository/plugins</span></tt> folder.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your plugin has external dependencies, they also need to be made available in the classpath of your web server! For the console server, simply drop them in <tt class="docutils literal"><span class="pre">jetty-distribution-&lt;version&gt;/lib/ext</span></tt>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you use the provided console server wrapper (which underneath uses jetty), then you can simply drop your plugins jar files under <tt class="docutils literal"><span class="pre">glu/repository/plugins</span></tt> (and your dependencies under <tt class="docutils literal"><span class="pre">jetty-distribution-&lt;version&gt;/lib/ext</span></tt>)  and you are done. On the other hand, if you use your own web server (tomcat, etc...) or your own version of jetty, make sure to configure it properly: the plugins need to be available from the same class space as the webapp. For example, with jetty, dropping your plugins jar files under the <tt class="docutils literal"><span class="pre">jetty-distribution-&lt;version&gt;/lib/ext</span></tt> does not work! Check the files <tt class="docutils literal"><span class="pre">bin/consolectl.sh</span></tt> and <tt class="docutils literal"><span class="pre">conf/console-jetty-context.xml</span></tt> to see how this is accomplished with jetty.</p>
</div>
<p>You then need to tell the console about it. For this you change the configuration file (<tt class="docutils literal"><span class="pre">conf/glu-console-webapp.groovy</span></tt>), by adding the class name(s) of your plugin(s):</p>
<div class="highlight-text"><div class="highlight"><pre>orchestration.engine.plugins = [
  &#39;org.linkedin.glu.orchestration.engine.plugins.builtin.StreamFileContentPlugin&#39;,
  &#39;org.acme.MyPlugin&#39;,
  // etc...
]
</pre></div>
</div>
</div>
<div class="section" id="list-of-hooks-available">
<h3>List of hooks available<a class="headerlink" href="#list-of-hooks-available" title="Permalink to this headline">¶</a></h3>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">For full documentation and typical use cases, refer to the class <a class="reference external" href="https://github.com/pongasoft/glu/tree/master/orchestration/org.linkedin.glu.orchestration-engine/src/main/groovy/org/linkedin/glu/orchestration/engine/plugins/builtin/DocumentationPlugin.groovy">DocumentationPlugin</a>.</p>
</div>
<ul class="simple">
<li>Initialization<ul>
<li><tt class="docutils literal"><span class="pre">PluginService_initialize</span></tt>: called for initializing your plugin</li>
</ul>
</li>
<li>User management<ul>
<li><tt class="docutils literal"><span class="pre">UserService_pre_authenticate</span></tt>: called before authentication</li>
<li><tt class="docutils literal"><span class="pre">UserService_post_authenticate</span></tt>: called after authentication</li>
<li><tt class="docutils literal"><span class="pre">UserService_pre_authorize</span></tt>: called before authorization</li>
<li><tt class="docutils literal"><span class="pre">UserService_post_authorize</span></tt>: called after authorization</li>
<li><tt class="docutils literal"><span class="pre">UserService_pre_restAuthenticateAndAuthorize</span></tt>: called before REST authentication and authorization flow</li>
<li><tt class="docutils literal"><span class="pre">UserService_post_restAuthenticateAndAuthorize</span></tt>: called after REST authentication and authorization flow</li>
</ul>
</li>
<li>Model<ul>
<li><tt class="docutils literal"><span class="pre">SystemService_pre_parseSystemModel</span></tt>: called before parsing the system model</li>
<li><tt class="docutils literal"><span class="pre">SystemService_post_parseSystemModel</span></tt>: called after parsing the system model</li>
</ul>
</li>
<li>Plans<ul>
<li><tt class="docutils literal"><span class="pre">PlannerService_pre_computePlans</span></tt>: called before computing a deployment plan</li>
<li><tt class="docutils literal"><span class="pre">PlannerService_post_computePlans</span></tt>: called after computing a deployment plan</li>
</ul>
</li>
<li>Deployment<ul>
<li><tt class="docutils literal"><span class="pre">DeploymentService_pre_executeDeploymentPlan</span></tt>: called before executing a deployment plan</li>
<li><tt class="docutils literal"><span class="pre">DeploymentService_onStart_executeDeploymentPlan</span></tt>: called when the deployment plan starts executing</li>
<li><tt class="docutils literal"><span class="pre">DeploymentService_post_executeDeploymentPlan</span></tt>: called after executing a deployment plan</li>
</ul>
</li>
<li>Commands<ul>
<li><tt class="docutils literal"><span class="pre">CommandsService_pre_executeCommand</span></tt>: called before executing a command</li>
<li><tt class="docutils literal"><span class="pre">CommandsService_post_executeCommand</span></tt>: called when the command is complete</li>
<li><tt class="docutils literal"><span class="pre">FileSystemCommandExecutionIOStorage_createInputStream</span></tt>: called to create the input stream to read the IO of the command from the filesystem</li>
<li><tt class="docutils literal"><span class="pre">FileSystemCommandExecutionIOStorage_createOutputStream</span></tt>:called to create the output stream to write the IO of the command from the filesystem</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="future-hooks">
<h3>Future hooks<a class="headerlink" href="#future-hooks" title="Permalink to this headline">¶</a></h3>
<p>Now that the plugin mechanism is in place, adding new hooks is not very complicated. If you have specific requirements for a new hook, please open a ticket on the <a class="reference external" href="https://github.com/pongasoft/glu/issues">glu ticketing system</a>.</p>
</div>
</div>
<div class="section" id="command-line">
<span id="goe-cli"></span><h2>Command Line<a class="headerlink" href="#command-line" title="Permalink to this headline">¶</a></h2>
<p>The orchestration engine also comes with a cli which is essentially a wrapper around the REST api which can be used in several ways:</p>
<ul class="simple">
<li>directly to issue commands</li>
<li>to build higher level cli(s) which use this cli as a base</li>
<li>as an example for how to talk to the REST api directly</li>
</ul>
<p>The cli currently requires python 2.6 to run.</p>
<div class="section" id="help">
<h3>Help<a class="headerlink" href="#help" title="Permalink to this headline">¶</a></h3>
<p>This is the output when using the <tt class="docutils literal"><span class="pre">-h</span></tt> option</p>
<p>Usage:</p>
<div class="highlight-text"><div class="highlight"><pre>console-cli.py -f &lt;fabric&gt; &lt;start|stop|bounce|deploy|undeploy|redeploy|load|status&gt; [flags]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The orchestration engine cli is currently called <tt class="docutils literal"><span class="pre">console-cli</span></tt> because of the fact that the orchestration engine is currently running inside the console.</p>
</div>
<p>Options:</p>
<dl class="option">
<dt id="cmdoption--version">
<tt class="descname">--version</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption--version" title="Permalink to this definition">¶</a></dt>
<dd><p>show program&#8217;s version number and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-h">
<tt class="descname">-h</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--help</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-h" title="Permalink to this definition">¶</a></dt>
<dd><p>show this help message and exit</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-d">
<tt class="descname">-d</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--debug</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn on debug output</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-c">
<tt class="descname">-c</tt><tt class="descclassname"> CONSOLEURL</tt><tt class="descclassname">, </tt><tt class="descname">--console</tt><tt class="descclassname">=CONSOLEURL</tt><a class="headerlink" href="#cmdoption-c" title="Permalink to this definition">¶</a></dt>
<dd><p>Url to glu Console for the given fabric.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-f">
<tt class="descname">-f</tt><tt class="descclassname"> FABRIC</tt><tt class="descclassname">, </tt><tt class="descname">--fabric</tt><tt class="descclassname">=FABRIC</tt><a class="headerlink" href="#cmdoption-f" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform action on a fabric</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-u">
<tt class="descname">-u</tt><tt class="descclassname"> USER</tt><tt class="descclassname">, </tt><tt class="descname">--user</tt><tt class="descclassname">=USER</tt><a class="headerlink" href="#cmdoption-u" title="Permalink to this definition">¶</a></dt>
<dd><p>glu user to use for authentication, defaults to <tt class="docutils literal"><span class="pre">$USER</span></tt></p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-x">
<tt class="descname">-x</tt><tt class="descclassname"> PASSWORD</tt><tt class="descclassname">, </tt><tt class="descname">--xpassword</tt><tt class="descclassname">=PASSWORD</tt><a class="headerlink" href="#cmdoption-x" title="Permalink to this definition">¶</a></dt>
<dd><p>Password. Warning password will appear in clear in <tt class="docutils literal"><span class="pre">ps</span></tt> output. Use only for testing.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-X">
<tt class="descname">-X</tt><tt class="descclassname"> PASSWORDFILE</tt><tt class="descclassname">, </tt><tt class="descname">--xpasswordfile</tt><tt class="descclassname">=PASSWORDFILE</tt><a class="headerlink" href="#cmdoption-X" title="Permalink to this definition">¶</a></dt>
<dd><p>Read user password from passwordfile specified. Make sure to protect this file using unix permissions</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-a">
<tt class="descname">-a</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--all</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-a" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform action on all entries</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-A">
<tt class="descname">-A</tt><tt class="descclassname"> AGENT</tt><tt class="descclassname">, </tt><tt class="descname">--agent</tt><tt class="descclassname">=AGENT</tt><a class="headerlink" href="#cmdoption-A" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform action on one or more agent(s)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-t">
<tt class="descname">-t</tt><tt class="descclassname"> ALLTAGS</tt><tt class="descclassname">, </tt><tt class="descname">--allTags</tt><tt class="descclassname">=ALLTAGS</tt><a class="headerlink" href="#cmdoption-t" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for querying by tags (all tags must be present): frontend;backend</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-T">
<tt class="descname">-T</tt><tt class="descclassname"> ANYTAG</tt><tt class="descclassname">, </tt><tt class="descname">--anyTag</tt><tt class="descclassname">=ANYTAG</tt><a class="headerlink" href="#cmdoption-T" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut for querying by tags (any of the tags need to be present): frontend;backend</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-I">
<tt class="descname">-I</tt><tt class="descclassname"> INSTANCE</tt><tt class="descclassname">, </tt><tt class="descname">--instance</tt><tt class="descclassname">=INSTANCE</tt><a class="headerlink" href="#cmdoption-I" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform action on one or more instance(s)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-p">
<tt class="descname">-p</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--parallel</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-p" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform action on all instances in parallel. Default is serial.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-n">
<tt class="descname">-n</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--dryrun</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-n" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a dry run of your plan. No changes will be made. Default is false.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-s">
<tt class="descname">-s</tt><tt class="descclassname"> FILTER</tt><tt class="descclassname">, </tt><tt class="descname">--systemFilter</tt><tt class="descclassname">=FILTER</tt><a class="headerlink" href="#cmdoption-s" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter in DSL sytax for filtering the model. Applicable only with &#8216;status&#8217; command. See <a class="reference internal" href="filtering.html#goe-filter-syntax"><em>Filter syntax</em></a>.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-S">
<tt class="descname">-S</tt><tt class="descclassname"> FILTERFILE</tt><tt class="descclassname">, </tt><tt class="descname">--systemFilterFile</tt><tt class="descclassname">=FILTERFILE</tt><a class="headerlink" href="#cmdoption-S" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter file with filters in DSL sytax for filtering the model. Applicable only with &#8216;status&#8217; command. See <a class="reference internal" href="filtering.html#goe-filter-syntax"><em>Filter syntax</em></a>.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-m">
<tt class="descname">-m</tt><tt class="descclassname"> MODEL</tt><tt class="descclassname">, </tt><tt class="descname">--model</tt><tt class="descclassname">=MODEL</tt><a class="headerlink" href="#cmdoption-m" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the model pointed to by model (should be a url!)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-M">
<tt class="descname">-M</tt><tt class="descclassname"> MODELFILE</tt><tt class="descclassname">, </tt><tt class="descname">--modelFile</tt><tt class="descclassname">=MODELFILE</tt><a class="headerlink" href="#cmdoption-M" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the model from the file</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-l">
<tt class="descname">-l</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--live</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-l" title="Permalink to this definition">¶</a></dt>
<dd><p>Show current model instead of expected model. Applicable only with &#8216;status&#8217; command.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-b">
<tt class="descname">-b</tt><tt class="descclassname"></tt><tt class="descclassname">, </tt><tt class="descname">--beautify</tt><tt class="descclassname"></tt><a class="headerlink" href="#cmdoption-b" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty print the model.</p>
</dd></dl>

<p>Unless you run the cli on the same host as the console you will need to specify its location:</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-text"><div class="highlight"><pre>-c https://glu.console.host:8443/console
</pre></div>
</div>
</div></blockquote>
<p>Here are some examples of usage:</p>
<div class="highlight-text"><div class="highlight"><pre># View the current loaded model (and format it for readability):
./bin/console-cli.py -f glu-dev-1 -u admin -x admin -b status

# View the live model only for applications in cluster cluster-1 (and format it for readability):
./bin/console-cli.py -f glu-dev-1 -u admin -x admin -b -l -s &quot;metadata.cluster=&#39;cluster-1&#39;&quot; status

# Show me what will happen if I bounce all applcations in cluster cluster-1 (but don&#39;t do it!):
./bin/console-cli.py -f glu-dev-1 -u admin -x admin -s &quot;metadata.cluster=&#39;cluster-1&#39;&quot; -n bounce

# Bounce all applcations in cluster cluster-1:
./bin/console-cli.py -f glu-dev-1 -u admin -x admin -s &quot;metadata.cluster=&#39;cluster-1&#39;&quot; bounce
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
</div>
<div class="sidebar">
  <div class="sidebar-entry">
    <h3>Table Of Contents</h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">What is glu?</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">A taste of glu (tutorial)</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent.html"> Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="glu-script.html"> glu script</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href=""> Orchestration engine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#key-components">Key Components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tracker-logo-tracker"> Tracker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#live-model-logo-live-model"> Live Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#from-the-console">From the console</a></li>
<li class="toctree-l4"><a class="reference internal" href="#from-the-command-line">From the command line</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#static-model-logo-static-model"> Static Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delta-service-logo-delta-service"> Delta Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delta-logo-delta"> Delta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizer-logo-visualizer"> Visualizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#planner-logo-planner"> Planner</a></li>
<li class="toctree-l3"><a class="reference internal" href="#plan-logo-deployment-plan"> Deployment Plan</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">From the Console</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">From the Command Line</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deployer-logo-deployer"> Deployer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rest-api">REST api</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#security-authorization">Security / Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-few-concepts">A few concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#api">API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fabric-details">Fabric details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-update-a-fabric">Add/Update a fabric</a></li>
<li class="toctree-l4"><a class="reference internal" href="#delete-a-fabric">Delete a fabric</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agents-count">Agents count</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-agents">List all the agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-agent-details">View agent details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remove-all-knowledge-of-an-agent">Remove all knowledge of an agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assign-a-fabric-to-an-agent">Assign a fabric to an agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#clears-the-fabric-for-an-agent">Clears the fabric for an agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-agents-versions">List all the agents versions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#upgrade-the-agents">Upgrade the agents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-plans">List all the plans</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-deployment-plan">Create deployment plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-a-deployment-plan">View a deployment plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execute-a-deployment-plan">Execute a deployment plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-plan-executions">List all the plan executions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#check-status-of-plan-execution">Check status of plan execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-execution-plan">View execution plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#abort-execution-plan">Abort execution plan</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-current-deployments">List all current deployments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#archive-all-current-deployments">Archive all current deployments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-current-deployment-details">View current deployment (details)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-current-deployment-info">View current deployment (info)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#archive-current-deployment">Archive current deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#archived-deployments-count">Archived deployments count</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-archived-deployments-paginated">List archived deployments (paginated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-archived-deployment-details">View archived deployment (details)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-archived-deployment-info">View archived deployment (info)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#load-static-model">Load static model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-static-model">View static model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-live-model">View live model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#view-delta">View delta</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-fabrics">List all the fabrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#list-all-the-agents-fabrics">List all the agents fabrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execute-a-shell-command">Execute a shell command</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-wait-for-command-result">Read/Wait for command result</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#api-examples">API Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#delta-formal-definition">Delta Formal Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#representing-a-plan">Representing a plan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#query-string-based">Query String based</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#json-dsl-based">Json/DSL Based</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plugins">Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-plugin">What is a plugin?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-do-you-install-a-plugin">How do you install a plugin?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#list-of-hooks-available">List of hooks available</a></li>
<li class="toctree-l3"><a class="reference internal" href="#future-hooks">Future hooks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#command-line">Command Line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#help">Help</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="static-model.html"> Static Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="filtering.html"> Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html"> Console</a></li>
<li class="toctree-l1"><a class="reference internal" href="production-setup.html">Production Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup.html">Development Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Latest changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="contents.html">All content</a></li>
</ul>

  </div>
<div class="sidebar-entry">
  <h3>Quick Links</h3>
  <ul class="quick-links">
    <li><a href="https://bintray.com/pkg/show/general/pongasoft/glu/releases/">Download</a>
    <li><a href="tutorial.html">Tutorial</a>
    <li><a href="http://www.github.com/pongasoft/glu">Source Code</a>
    <li><a href="http://glu.977617.n3.nabble.com/">Forum / Questions / Help</a>
    <li><a href="http://devops.com/2011/07/09/glu-deployment-automation-video/">Video (July 2011)</a>
    <li><a href="https://plus.google.com/111352340806201326494?prsrc=3" rel="publisher" style="text-decoration:none;">Google+<img src="https://ssl.gstatic.com/images/icons/gplus-32.png" alt="" style="border:0;width:16px;height:16px;margin:0;padding:0 0 0 .5em;vertical-align:middle"/></a>
    <li><a href="https://plus.google.com/communities/118019862679241960849">Google+ Community</a></li>
    <li><a href="http://twitter.com/glutweets">Twitter</a>
    <li><a href="https://github.com/pongasoft/glu/issues">Issues / Tasks</a>
    <li><a href="RELEASE.html">Latest Changes</a>
  </ul>
</div>
<div class="sidebar-entry">
  <h3>Technologies</h3>
  <ul class="quick-links">
    <li><a href="http://www.ej-technologies.com/products/jprofiler/overview.html">JProfiler</a>
  </ul>
</div>
  <div class="sidebar-entry">
    <h3>Twitter</h3>
    <script type="text/javascript">
      new TWTR.Widget({
                        version: 2,
                        type: 'profile',
                        rpp: 4,
                        interval: 6000,
                        width: 'auto',
                        height: 300,
                        theme: {
                          shell: {
                            background: '#dddddd',
                            color: '#000000'
                          },
                          tweets: {
                            background: '#ffffff',
                            color: '#000000',
                            links: '#ce5c00'
                          }
                        },
                        features: {
                          scrollbar: false,
                          loop: false,
                          live: false,
                          hashtags: true,
                          timestamp: true,
                          avatars: true,
                          behavior: 'all'
                        }
                      }).render().setUser('glutweets').start();
    </script>
  </div>
</div>
<div class="clearer"></div>
</div>

</div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="glu-script.html" title="glu script"
             >previous</a> |
          <a href="static-model.html" title="Static Model"
             >next</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2011-2013, Yan Pujante.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>